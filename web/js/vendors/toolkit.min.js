/*! Titon Toolkit v2.1.3 | BSD-3 License | titon.io */
!function(t,e,i){"use strict";function s(e,i,s){return"undefined"===t.type(s)?e.getAttribute("aria-"+i):(s===!0?s="true":s===!1&&(s="false"),void e.setAttribute("aria-"+i,s))}var n=!!("ontouchstart"in e||e.DocumentTouch&&i instanceof DocumentTouch),o=e.devicePixelRatio>1,a="rtl"===i.documentElement.dir,r=function(){for(var t="transition WebkitTransition MozTransition OTransition msTransition".split(" "),e=i.createElement("div").style,s=0;s<t.length;s++)if(t[s]in e)return t[s];return!1}(),h=function(){var t={WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd otransitionend"};return t[r]||"transitionend"}();t.fn.cache=function(e,i){var s=this.data(e),n=t.type(s);return"undefined"!==n&&"null"!==n?s:("function"===t.type(i)&&(i=i.call(this)),this.data(e,i),i)};var l={version:"2.1.3",build:"i9bz04n6",namespace:"",aria:!0,debug:!1,messages:{loading:"Loading...",error:"An error has occurred!"},bemSeparators:["-","--"],hasTransition:r,isTouch:n,isRetina:o,isRTL:a,transitionEnd:h,cache:{},bem:function(t,e,i){var s=l.bemSeparators;return e&&(t+=s[0]+e),i&&(t+=s[1]+i),l.namespace+t},buildTemplate:function(t){return"function"==typeof t&&(t=t.call(null,l.bem,l.namespace)),t+""},createPlugin:function(e,i,s){var n=e;t.fn[n]&&(n="toolkit"+n.charAt(0).toUpperCase()+n.slice(1)),t.fn[n]=s?function(){var s=l.cache[e+":"+this.selector]=i.apply(this,arguments);return this.each(function(){t(this).cache("toolkit."+e,s)})}:function(){var s=arguments;return this.each(function(){t(this).cache("toolkit."+e,i.apply(this,s))})}}};e.Toolkit=l,l.Class=function(){};var d=!1;l.Class.extend=function(e,i){function s(){if(!d){for(var e in this){var i=this[e],n=t.type(i);"array"===n?this[e]=i.slice(0):"object"===n&&(this[e]=t.extend(!0,{},i))}this.uid=s.count+=1;var a=this.name;a&&(this.cssClass=a.replace(/[A-Z]/g,function(t){return"-"+t.charAt(0).toLowerCase()}).slice(1),this.keyName=a.charAt(0).toLowerCase()+a.slice(1)),o&&o.apply(this,arguments)}}d=!0;var n=new this;d=!1,t.extend(n,e);var o=n.constructor;return s.prototype=n,s.prototype.constructor=o||s,s.options=t.extend(!0,{},this.options||{},i||{}),s.extend=this.extend,s.count=0,s},l.Base=l.Class.extend({name:"Base",version:"2.0.0",cache:{},enabled:!1,options:{},__events:[],__hooks:{},addEvent:function(e,i,s,n){var o=this.options;"{mode}"===e&&(e=o.mode),"{selector}"===n&&(n=this.nodes?this.nodes.selector:""),"string"===t.type(s)&&(s=this[s].bind(this)),this.__events.push([e,i,s,n])},addEvents:function(e){t.each(e,function(t,e){this.addEvent.apply(this,e)}.bind(this))},addHook:function(t,e){var i=this.__hooks[t]||[];i.push(e),this.__hooks[t]=i},addHooks:function(e,i){t.each(i,function(t,i){this.addHook(e,i)}.bind(this))},bindEvents:function(s){var n,o,a,r,h=this,l=t(e),d=t(i);t.each(this.__events,function(e,i){n=i[0],o=i[1],a=i[2],r=i[3],h[o]?o=h[o]:"window"===o?o=l:"document"===o&&(o=d),"ready"===n?d.ready(a):r?t(o)[s](n,r,a):t(o)[s](n,a)})},destroy:function(){this.fireEvent("destroying"),this.destructor&&this.destructor(),this.doDestroy&&this.doDestroy(),this.disable(),this.fireEvent("destroyed")},disable:function(){this.enabled&&this.bindEvents("off"),this.enabled=!1},enable:function(){this.enabled||this.bindEvents("on"),this.enabled=!0},fireEvent:function(e,i){var s=this.options.debug||l.debug;s&&(console.log(this.name+"#"+this.uid,(new Date).getMilliseconds(),e,i||[]),"verbose"===s&&console.dir(this));var n=this.__hooks[e];n&&t.each(n,function(t,e){e.apply(this,i||[])}.bind(this))},initialize:function(){this.enable(),this.fireEvent("init")},removeHook:function(e,i){if(!i)return void delete this.__hooks[e];var s=this.__hooks[e];s&&t.each(s,function(t,e){e===i&&(s=s.splice(t,1))})},setOptions:function(i){var s,n=t.extend(!0,{},l[this.name].options,i||{});n.responsive&&e.matchMedia&&t.each(n.responsive,function(e,i){matchMedia(i.breakpoint).matches&&t.extend(n,i)});for(s in n)s.match(/^on[A-Z]/)&&(this.addHook(s.substr(2).toLowerCase(),n[s]),delete n[s]);return this.options=n,n}},{cache:!0,debug:!1}),t.fn.aria=function(e,i){return l.aria?("toggled"===e&&(e={expanded:i,selected:i},i=null),t.access(this,s,e,i,arguments.length>1)):this},t.fn.transitionend=function(e,i){if(arguments.length>0){this.one(h,null,e,i);var s=this.css("transition-duration");("0s"===s||"undefined"===t.type(s))&&this.trigger(h)}else this.trigger(h);return this},t.fn.conceal=function(e){return this.hasClass("show")&&!e&&this.transitionend(function(){t(this).hide()}),this.removeClass("show").addClass("hide").aria("hidden",!0)},t.fn.reveal=function(t){return t||this.show(),setTimeout(function(){this.removeClass("hide").addClass("show").aria("hidden",!1)}.bind(this),1),this},t.fn.toolkit=function(e,i,s){var n=this.selector,o=this.data("toolkit."+e)||l.cache[e+":"+n]||null;return o?(i&&o[i]&&o[i].apply(o,t.makeArray(s)),o):null},l.Component=l.Base.extend({name:"Component",version:"2.1.0",element:null,namespace:"",node:null,constructor:function(t,e){this.setElement(t),this.setOptions(e,this.element)},fireEvent:function(e,i){l.Base.prototype.fireEvent.call(this,e,i);var s=this.element,n=this.node,o=t.Event(e+".toolkit."+this.keyName);o.context=this,s&&s.trigger(o,i||[]),n&&n.trigger(o,i||[])},hide:function(){this.fireEvent("hiding"),this.element.conceal(),this.fireEvent("hidden")},id:function(){var e=t.makeArray(arguments);return e.unshift("toolkit",this.cssClass,this.uid),e.join("-")},inheritOptions:function(e,i){var s,n,o={};for(s in e)"context"!==s&&"template"!==s&&(n=i.data((this.keyName+"-"+s).toLowerCase()),"undefined"!==t.type(n)&&(o[s]=n));return t.extend(!0,{},e,o)},loadContent:function(e,i){var s=!1;e.match(/^#[a-z0-9_\-\.:]+$/i)?e=t(e).html():(e.match(/^([a-z]+:)?\/\//)||e.match(/^\/[\w\-\.\/]+/i))&&(s=!0),this.cache[e]?this.position(this.cache[e]):s?this.requestData(e,i):this.position(e)},ns:function(t,e){var i="data-"+(e||this.keyName);return t&&(i+="-"+t),this.namespace&&(i+='="'+this.namespace+'"'),"["+i+"]"},position:function(t){this.fireEvent("load",[t])},process:function(t){if(t.callback){for(var i=t.callback.split("."),s=e,n=s,o=0;o<i.length;o++)n=s,s=s[i[o]];s.call(n,t)}this.fireEvent("process",[t]),this.hide()},readOption:function(e,i){var s=e.data((this.keyName+"-"+i).toLowerCase());return"undefined"===t.type(s)&&(s=this.options[i]),s},readValue:function(e,i){return i?(e=t(e),"function"===t.type(i)?i.call(this,e):e.attr(i)):null},render:function(e){return t(l.buildTemplate(e))},requestData:function(e,i){var s={};return"object"===t.type(this.options.ajax)&&(s=this.options.ajax),"string"===t.type(e)?s.url=e:t.extend(s,e),s.context=this,s.beforeSend=function(t){t.url=s.url,t.cache=(!s.type||"GET"===s.type.toUpperCase())&&this.options.cache,t.settings=s,t.params=i||{},this.onRequestBefore.call(this,t)},t.ajax(s).done(this.onRequestDone).fail(this.onRequestFail)},setElement:function(e){return this.element=e=t(e),this.namespace=e.data(this.keyName)||"",e},setOptions:function(e,i){if(i){var s=this.readOption(i,"group");s&&e.groups[s]&&t.extend(e,e.groups[s])}var n=l.Base.prototype.setOptions.call(this,e);return i&&(n=this.inheritOptions(n,i)),n.mode&&"hover"===n.mode&&(n.mode=l.isTouch?"click":"mouseenter"),this.options=n,n},show:function(e){e&&(this.node=t(e)),this.fireEvent("showing"),this.element.reveal(),this.fireEvent("shown")},doDestroy:function(){this.element&&this.element.removeData("toolkit."+this.keyName)},onHide:function(){this.element.is(":shown")&&this.hide()},onRequestBefore:function(t){this.cache[t.url]=!0,this.element.addClass("is-loading").aria("busy",!0)},onRequestDone:function(t,e,i){var s=i.url;this.element.removeClass("is-loading").aria("busy",!1),delete this.cache[s],i.getResponseHeader("Content-Type").indexOf("text/html")>=0?(i.cache&&(this.cache[s]=t),this.position(t)):this.process(t)},onRequestFail:function(t){delete this.cache[t.url],this.element.removeClass("is-loading").addClass("has-failed").aria("busy",!1),this.position(l.messages.error)},onShow:function(t){t.preventDefault(),this.show(t.currentTarget)}},{ajax:{},context:null,className:""}),l.TemplateComponent=l.Component.extend({createElement:function(e){e=e||this.options;var i=t(e.templateFrom);if(i.length||(i=this.render(e.template)),!i.length)throw new Error("Failed to render template");return e.className&&i.addClass(e.className),e.animation&&i.addClass(e.animation),i.attr("id",this.id()).conceal(!0).hide().appendTo("body")},doDestroy:function(){l.Component.prototype.doDestroy.call(this),this.element.remove()}},{template:"",templateFrom:""}),l.CompositeComponent=l.TemplateComponent.extend({elements:{},nodes:null,wrapper:null,createElement:function(t,e){e=this.inheritOptions(e||this.options,t);var i=l.TemplateComponent.prototype.createElement.call(this,e);this.wrapper&&i.appendTo(this.wrapper);var s=t.data("toolkit.cid");return i.attr("id",this.id(s)).data("toolkit.cid",s)},createWrapper:function(){var t=this.options;return this.wrapper=this.render(t.wrapperTemplate).addClass(l.buildTemplate(t.wrapperClass)).attr("id",this.id("wrapper")).appendTo("body")},hideElements:function(){t.each(this.elements,function(e,i){t(i).conceal()})},loadElement:function(e,i){var s,n=this.elements,o=t(e).cache("toolkit.cid",function(){return Math.random().toString(32).substr(2)});return n[o]?s=n[o]:(s=n[o]=this.createElement(e),"function"===t.type(i)&&i.call(this,s)),this.element=s},doDestroy:function(){var t=this.keyName;this.nodes&&(this.nodes.removeData("toolkit."+t),delete l.cache[t+":"+this.nodes.selector]),this.hideElements(),this.wrapper&&this.wrapper.remove()},onShowToggle:function(e){var i,s=t(e.currentTarget),n=this.node&&this.node.is(s),o=s.data("toolkit.cid");if(i=o&&this.elements[o]?this.elements[o]:this.element,i&&i.is(":shown")){if(l.isTouch?n&&"a"===this.node.prop("tagName").toLowerCase()||e.preventDefault():e.preventDefault(),n)return void("click"===this.options.mode&&this.hide())}else e.preventDefault();this.show(s)}},{wrapperClass:"",wrapperTemplate:'<div class="toolkit-plugin"></div>'}),t.bound=function(t,e,i){return i=i||0,t>=e?t=i:i>t&&(t=e-1),t},t.expr[":"].shown=function(e){return"hidden"!==t(e).css("visibility")},t.event.special.horizontalresize=function(){function i(e){var i=s.width();i!==n&&(n=i,t(e.target).trigger("horizontalresize"))}var s=t(e),n=s.width();return{setup:function(){s.on("resize",i)},teardown:function(){s.off("resize",i)}}}(),l.Accordion=l.Component.extend({name:"Accordion",version:"2.0.0",headers:[],index:0,sections:[],constructor:function(e,i){var s=this;e=this.setElement(e).attr("role","tablist"),i=this.setOptions(i,e),this.headers=e.find(this.ns("header")).each(function(e){t(this).data("accordion-index",e).attr({role:"tab",id:s.id("header",e)}).aria({controls:s.id("section",e),selected:!1,expanded:!1})}),this.sections=e.find(this.ns("section")).each(function(e){t(this).attr({role:"tabpanel",id:s.id("section",e)}).aria("labelledby",s.id("header",e)).conceal()}),this.addEvents([["horizontalresize","window",t.debounce(this.calculate.bind(this))],["{mode}","element","onShow",this.ns("header")]]),this.initialize(),this.calculate(),this.jump(i.defaultIndex)},destructor:function(){this.headers.addClass("is-active").attr("toggled",!0),this.sections.attr("style","").reveal()},calculate:function(e){"function"!==t.type(e)&&(e=function(t){return t.outerHeight()}),this.sections.each(function(){var i=t(this),s=i.hasClass("hide")?"hide":"show",n=i.css("max-height");i.addClass("no-transition").removeClass(s).css("max-height","");var o=e.call(this,i);i.addClass(s).css("max-height",n).removeClass("no-transition"),i.data("accordion-height",o),i.hasClass("show")&&i.css("max-height",o)})},jump:function(e){this.show(this.headers[t.bound(e,this.headers.length)])},show:function(e){e=t(e);var i=this.options,s=e.next(),n=e.data("accordion-index"),o=parseInt(s.data("accordion-height"),10),a=this.node&&this.node.is(e);if(this.fireEvent("showing",[s,e,this.index]),"click"===i.mode&&(i.multiple||i.collapsible&&a))s.is(":shown")&&this.node?(s.css("max-height",0).conceal(!0),e.aria("toggled",!1).removeClass("is-active")):(s.css("max-height",o).reveal(!0),e.aria("toggled",!0).addClass("is-active"));else{if(a)return;this.sections.css("max-height",0).conceal(!0),s.css("max-height",o).reveal(!0),this.headers.aria("toggled",!1).removeClass("is-active"),e.aria("toggled",!0).addClass("is-active")}this.index=n,this.node=e,this.fireEvent("shown",[s,e,n])}},{mode:"click",defaultIndex:0,multiple:!1,collapsible:!1}),l.createPlugin("accordion",function(t){return new l.Accordion(this,t)});var c=null;l.Blackout=l.TemplateComponent.extend({name:"Blackout",version:"2.0.0",count:0,loader:null,message:null,constructor:function(t){t=this.setOptions(t),this.element=this.createElement(),this.loader=this.render(t.loaderTemplate).appendTo(this.element),this.message=this.loader.find(this.ns("message","loader")),t.showLoading&&this.message.html(l.messages.loading),this.initialize()},destructor:function(){this.element.remove(),c=null},hide:function(){this.fireEvent("hiding");var t=this.count-1;0>=t?(this.count=0,this.element.conceal()):this.count=t,this.hideLoader(),this.fireEvent("hidden",[0>=t])},hideLoader:function(){this.loader.hide()},show:function(){this.fireEvent("showing");var t=!1;this.count++,1===this.count&&(this.element.reveal(),t=!0),this.showLoader(),this.fireEvent("shown",[t])},showLoader:function(){this.loader.show()}},{showLoading:!0,template:function(t){return'<div class="'+t("blackout")+'"></div>'},templateFrom:"#toolkit-blackout-1",loaderTemplate:function(t){return'<div class="'+t("loader")+' bar-wave"><span></span><span></span><span></span><span></span><span></span><div class="'+t("loader","message")+'" data-loader-message></div></div>'}}),l.Blackout.instance=function(t){return c?c:c=new l.Blackout(t)},t.event.special.swipe=function(){function e(t){var e=t.originalEvent.changedTouches?t.originalEvent.changedTouches[0]:t;return{time:(new Date).getTime(),x:e.pageX,y:e.pageY}}function i(e,i,s,n){if(e&&i){var o,a=t.event.special.swipe,r=i.x-e.x,l=i.y-e.y;if(i.time-e.time<=a.duration){if(h(r)>=a.distance&&h(l)<=a.restraint)o=0>r?"left":"right";else{if(!(h(l)>=a.distance&&h(r)<=a.restraint))return;o=0>l?"up":"down"}var d={target:n,swipestart:e,swipestop:i};s.trigger(t.Event("swipe",d)).trigger(t.Event("swipe"+o,d))}}}var s=n?"touchstart":"mousedown",o=n?"touchmove":"mousemove",a=n?"touchend":"mouseup",r=!1,h=Math.abs;return{duration:1e3,distance:50,restraint:75,setup:function(){function l(t){var i=e(t);h(c.x-i.x)>h(c.y-i.y)&&t.preventDefault()}function d(){c=u=null,r=!1,p.off(o,l)}var c,u,p=t(this);p.on(s,function(t){n||"img"!==t.target.tagName.toLowerCase()||t.preventDefault(),r||(c=e(t),u=t.target,r=!0,n&&p.on(o,l))}),p.on(a,function(t){i(c,e(t),p,u),d()}),p.on("touchcancel",d)},teardown:function(){t(this).off(s).off(o).off(a).off("touchcancel")}}}(),t.each("swipe swipeleft swiperight swipeup swipedown".split(" "),function(e,i){"swipe"!==i&&(t.event.special[i]={setup:function(){t(this).on("swipe",t.noop)},teardown:function(){t(this).off("swipe")}})}),t.throttle=function(t,e){if(!e)return t;var i=!1;return function(){var s=this,n=arguments;i||(i=!0,setTimeout(function(){t.apply(s,n),i=!1},e))}},l.Carousel=l.Component.extend({name:"Carousel",version:"2.1.0",animating:!1,container:null,index:-1,items:[],stopped:!1,tabs:[],timer:null,_dimension:"",_position:"",_size:0,_resetTo:null,constructor:function(e,i){var s,n=this;e=this.setElement(e),i=this.setOptions(i,e),e.aria("live",i.autoCycle?"assertive":"off").addClass(i.animation),this.container=e.find(this.ns("items")).addClass("no-transition"),this.items=s=this.container.find("> li").each(function(e){t(this).attr({role:"tabpanel",id:n.id("item",e)}).data("carousel-index",e).aria("hidden",e>0)}),this.tabs=e.find(this.ns("tabs")).attr("role","tablist").find("a").each(function(e){t(this).data("carousel-index",e).attr({role:"tab",id:n.id("tab",e)}).aria({controls:n.id("item",e),selected:!1,expanded:!1})}),this.addEvents([["resize","window",t.throttle(this.calculate.bind(this),50)],["keydown","window","onKeydown"],["click","element","onJump",this.ns("tabs")+" a"],["click","element","next",this.ns("next")],["click","element","prev",this.ns("prev")],["click","element","start",this.ns("start")],["click","element","stop",this.ns("stop")]]),i.swipe&&this.addEvents([["swipeleft","element","next"],["swipeup","element","next"],["swiperight","element","prev"],["swipedown","element","prev"]]),i.stopOnHover&&this.addEvents([["mouseenter","element","stop"],["mouseleave","element","start"]]),this.initialize(),this._setupState(),this._buildClones(),this.calculate(),this.start(),this.jump(i.defaultIndex)},destructor:function(){this.stop(),this.jump(0);var e=this._position||"left";this.container.transitionend(function(){t(this).addClass("no-transition").css(e,0).find("li.is-cloned").remove()})},calculate:function(){if("fade"!==this.options.animation){var t,e=this._dimension;this._size=t=this.element[e]()/this.options.itemsToShow;var i=this.items.css(e,t);this.container.css(e,t*i.length)}},jump:function(t){if(!this.animating){var e=this._getIndex(t),i=e[0],s=e[1];s!==this.index&&(this.fireEvent("jumping",[this.index]),this._updateTabs(s),this._updateItems(i),this._beforeCycle(),"fade"===this.options.animation?this.items.conceal(!0).eq(s).transitionend(this._afterCycle.bind(this)).reveal(!0):this.container.transitionend(this._afterCycle.bind(this)).css(this._position,-(i*this._size)),this.index=s,this.reset(),this.fireEvent("jumped",[s]))}},next:function(){this.jump(this.index+this.options.itemsToCycle)},prev:function(){this.jump(this.index-this.options.itemsToCycle)},reset:function(){this.options.autoCycle&&(clearInterval(this.timer),this.timer=setInterval(this.onCycle.bind(this),this.options.duration))},start:function(){this.element.removeClass("is-stopped"),this.stopped=!1,this.fireEvent("start")},stop:function(){this.element.addClass("is-stopped"),this.stopped=!0,clearInterval(this.timer),this.fireEvent("stop")},_afterCycle:function(){this.animating=!1;var t=this.container,e=this._resetTo;null!==e&&(t.addClass("no-transition").css(this._position,-(e*this._size)),this._updateItems(e),this._resetTo=null),setTimeout(function(){t.removeClass("no-transition"),this.fireEvent("cycled")}.bind(this),15)},_beforeCycle:function(){this.animating=!0,this.fireEvent("cycling")},_buildClones:function(){var t=this.options,e=this.items,i=this.container,s=t.itemsToShow;t.infinite&&(e.slice(0,s).clone().addClass("is-cloned").removeAttr("id").removeAttr("role").appendTo(i),e.slice(-s).clone().addClass("is-cloned").removeAttr("id").removeAttr("role").prependTo(i),this.items=i.find("> li"))},_getIndex:function(t){var e,i,s=this.options,n=s.itemsToShow;if(t=parseInt(t,10),s.infinite){var o=this.items.length,a=o-2*n;t>=a?(this._resetTo=0+n,i=o-n,e=0):-n>=t?(this._resetTo=a,i=0,e=a-n):(this._resetTo=null,e=t,i=t+n)}else{var r=this.element.removeClass("no-next no-prev"),h=this.items.length-n;t>=h?(t=h,s.loop?t===this.index&&this.index===h&&(t=0):r.addClass("no-next")):0>=t&&(t=0,s.loop?t===this.index&&0===this.index&&(t=h):r.addClass("no-prev")),i=e=t}return[i,e]},_setupState:function(){var t=this.options,e=t.animation;t.itemsToCycle>t.itemsToShow&&(t.itemsToCycle=t.itemsToShow),"fade"===e&&(t.itemsToShow=t.itemsToCycle=1,t.infinite=!1),"slide-up"===e?(this._dimension="height",this._position="top"):"slide"===e&&(this._dimension="width",this._position=t.rtl?"right":"left")},_updateItems:function(t){this.items.removeClass("is-active").aria("hidden",!0).slice(t,t+this.options.itemsToShow).addClass("is-active").aria("hidden",!1)},_updateTabs:function(e){var i=this.options.itemsToShow,s=this.items.length,n=e+i,o=t([]),a=this.tabs.removeClass("is-active").aria("toggled",!1);a.length&&(this.options.infinite&&(s-=2*i),e>=0?o=o.add(a.slice(e,n)):(o=o.add(a.slice(0,n)),o=o.add(a.slice(e))),n>s&&(o=o.add(a.slice(0,n-s))),o.addClass("is-active").aria("toggled",!0))},onCycle:function(){this.stopped||(this.options.reverse?this.prev():this.next())},onJump:function(e){e.preventDefault(),this.jump(t(e.currentTarget).data("carousel-index")||0)},onKeydown:function(t){switch(t.keyCode){case 37:this.prev();break;case 38:this.jump(0);break;case 39:this.next();break;case 40:this.jump(-1);break;default:return}t.preventDefault()}},{animation:"slide",duration:5e3,autoCycle:!0,stopOnHover:!0,infinite:!0,loop:!0,reverse:!1,rtl:l.isRTL,swipe:l.isTouch,itemsToShow:1,itemsToCycle:1,defaultIndex:0}),l.createPlugin("carousel",function(t){return new l.Carousel(this,t)}),t.event.special.clickout=function(){var e=[];return t(i).on(n?"touchend":"click",function(s){if(e.length){var n=!0,o=t(i),a=t(s.target);t.each(e,function(e,i){var r=t(i);return(n="string"===t.type(i)?!a.is(i)&&!r.has(s.target).length:!r.is(s.target)&&!r.has(s.target).length)?void(o=o.add(r)):!1}),n&&o.trigger("clickout",[s.target])}}),{add:function(s){var n=this;this===i&&(n=s.selector),-1===t.inArray(n,e)&&e.push(n)},remove:function(s){var n=this;this===i&&(n=s.selector),e=t.grep(e,function(t){return t!==n})}}}(),l.Drop=l.CompositeComponent.extend({name:"Drop",version:"2.1.0",constructor:function(e,i){this.nodes=t(e),this.setOptions(i),this.addEvents([["clickout","document","hide",this.ns("menu")],["clickout","document","hide","{selector}"],["{mode}","document","onShow","{selector}"]]),this.initialize()},destructor:function(){this.hide(),t(this.ns("menu")).conceal()},createElement:function(e){var i=this.readValue(e,this.options.getTarget);if(!i||"#"!==i.substr(0,1))throw new Error("Drop menu "+i+" does not exist");return t(i)},hide:function(){var t=this.element,e=this.node;(t||e)&&(this.fireEvent("hiding",[t,e]),t.conceal(),e.aria("toggled",!1).removeClass("is-active"),this.fireEvent("hidden",[t,e]))},show:function(e){this.node=e=t(e);var i=this.loadElement(e);this.fireEvent("showing",[i,e]),i.reveal(),e.aria("toggled",!0).addClass("is-active"),this.fireEvent("shown",[i,e])},onShow:function(e){e.preventDefault(),this.hide();var i=t(e.currentTarget),s=this.loadElement(i);s.is(":shown")?this.hide():this.show(i)}},{mode:"click",getTarget:"data-drop"}),l.createPlugin("drop",function(t){return new l.Drop(this,t)},!0),l.Flyout=l.CompositeComponent.extend({name:"Flyout",version:"2.1.3",url:"",data:[],dataMap:{},timers:{},constructor:function(e,i,s){l.isTouch||(this.nodes=t(e),s=this.setOptions(s),this.createWrapper(),this.addEvents("click"===s.mode?[["click","document","onShowToggle","{selector}"],["resize","window",t.debounce(this.onHide.bind(this))]]:[["mouseenter","document","onShowToggle","{selector}"],["mouseenter","document","onEnter","{selector}"],["mouseleave","document","onLeave","{selector}"]]),this.initialize(),i&&t.getJSON(i,function(t){this.load(t)}.bind(this)))},destructor:function(){this.clearTimer("show"),this.clearTimer("hide")},clearTimer:function(t){clearTimeout(this.timers[t]),delete this.timers[t]},hide:function(){this.fireEvent("hiding"),this.element.conceal(),this.node.removeClass("is-active"),this.fireEvent("hidden")},load:function(t,e){if(e=e||0,e||(this.data=t),t.url&&(this.dataMap[t.url]=t),t.children)for(var i=0,s=t.children.length;s>i;i++)this.load(t.children[i],e+1)},position:function(){var i=this.options,s=this.node,n=this.loadElement(s);if(n.children().length){this.fireEvent("showing");var o=n.outerHeight(),a=s.offset(),r=a.left+i.xOffset,h=a.top+i.yOffset+s.outerHeight(),d=t(e).height(),c="left";h>d/2&&(h=a.top-i.yOffset-o),l.isRTL&&(r=t(e).width()-a.left-s.outerWidth(),c="right"),n.css("top",h).css(c,r).reveal(),this.fireEvent("shown")}},show:function(e){e=t(e);var i=this.readValue(e,this.options.getUrl)||e.attr("href");this.url&&i!==this.url&&(this.hide(),this.startTimer("show",this.options.showDelay)),this.url=i,this.node=e.addClass("is-active"),this.loadElement(e,function(t){t.addClass("is-root"),this.dataMap[i]&&this._buildMenu(t,this.dataMap[i])}),"click"===this.options.mode&&this.position()},startTimer:function(t,e,i){this.clearTimer(t);var s;s="show"===t?this.position:this.hide,s&&(this.timers[t]=setTimeout(function(){s.apply(this,i||[])}.bind(this),e))},_buildMenu:function(e,i){if(i.children&&i.children.length){var s,n,o,a,r,h=this.options,d=[],c=h.itemLimit;if(h.className&&e.addClass(h.className),e.aria("expanded",!1).attr("role","menu"),c&&i.children.length>c)for(a=0,r=i.children.length;r>a;)d.push(i.children.slice(a,a+=c));else d.push(i.children);for(var u,p,f=0;u=d[f];f++){for(s=t("<ul/>"),a=0,r=u.length;r>a;a++)if(p=u[a],p.url?(n=t("<li/>"),o=t("<a/>",{text:p.title,href:p.url,role:"menuitem"}),t("<span/>").addClass(p.icon||(l.isRTL?"caret-left":"caret-right")).prependTo(o)):(n=this.render(h.template),o=t("<span/>",{text:p.title,role:"presentation"})),p.attributes&&o.attr(p.attributes),p.className&&n.addClass(p.className),n.append(o).appendTo(s),p.children&&p.children.length){var m=this.render(h.template).conceal().appendTo(n);this._buildMenu(m,p),n.addClass("has-children").aria("haspopup",!0).on("mouseenter",this.onPositionChild.bind(this,n)).on("mouseleave",this.onHideChild.bind(this,n))}e.append(s)}"click"!==h.mode&&e.hasClass("is-root")&&e.on({mouseenter:function(){this.clearTimer("hide")}.bind(this),mouseleave:function(){this.startTimer("hide",h.hideDelay)}.bind(this)})}},onEnter:function(){this.clearTimer("hide"),this.startTimer("show",this.options.showDelay)},onHideChild:function(e){e=t(e),e.removeClass("is-open"),e.children(this.ns("menu")).removeAttr("style").aria({expanded:!1,hidden:!1}).conceal(),this.fireEvent("hideChild",[e])},onLeave:function(){this.clearTimer("show"),this.startTimer("hide",this.options.showDelay)},onPositionChild:function(i){var s=i.children(this.ns("menu"));if(s){s.aria({expanded:!0,hidden:!0});var n=s.children();s.css("width",n.outerWidth()*n.length+"px");var o=t(e),a=o.height()+o.scrollTop(),r=i.offset(),h=i.outerHeight(),d="push-opposite";l.isRTL?r.left-s.outerWidth()<0?s.addClass(d):s.removeClass(d):r.left+i.outerWidth()+s.outerWidth()>=o.width()?s.addClass(d):s.removeClass(d),r.top>a/2?s.css("top","-"+(s.outerHeight()-h)+"px"):s.css("top",0),i.addClass("is-open"),s.reveal(),this.fireEvent("showChild",[i])}}},{mode:"hover",getUrl:"href",xOffset:0,yOffset:0,showDelay:350,hideDelay:1e3,itemLimit:15,wrapperClass:function(t){return t("flyouts")},template:function(t){return'<div class="'+t("flyout")+'" data-flyout-menu></div>'},headingTemplate:function(t){return'<li class="'+t("flyout","heading")+'"></li>'}}),l.createPlugin("flyout",function(t,e){return new l.Flyout(this,t,e)},!0),t.fn.toString=function(){return this.prop("outerHTML")},l.Input=l.Component.extend({name:"Input",version:"2.1.0",input:null,wrapper:null,constructor:function(t,e){t=this.setElement(t),e=this.setOptions(e,t),e.checkbox&&t.find(e.checkbox).inputCheckbox(e),e.radio&&t.find(e.radio).inputRadio(e),e.select&&t.find(e.select).inputSelect(e),this.initialize()},destructor:function(){var e=this.options,i=this.element;"Input"===this.name?(e.checkbox&&i.find(e.checkbox).each(function(){t(this).toolkit("inputCheckbox","destroy")}),e.radio&&i.find(e.radio).each(function(){t(this).toolkit("inputRadio","destroy")}),e.select&&i.find(e.select).each(function(){t(this).toolkit("inputSelect","destroy")})):this.wrapper&&(this.wrapper.replaceWith(i),i.removeAttr("style"))},copyClasses:function(e,i){var s=(t(e).attr("class")||"").replace(this.options.filterClasses,"").trim();s&&t(i).addClass(s)},_buildWrapper:function(){var t=this.element,e=this.render(this.options.template).insertBefore(t).append(t);return this.options.copyClasses&&this.copyClasses(t,e),e}},{copyClasses:!0,filterClasses:/\binput\b/,checkbox:"input:checkbox",radio:"input:radio",select:"select",template:function(t){return'<div class="'+t("custom-input")+'"></div>'}}),l.InputCheckbox=l.Input.extend({name:"InputCheckbox",version:"2.1.0",constructor:function(e,i){this.element=e=t(e),i=this.setOptions(i,e),this.wrapper=this._buildWrapper(),this.input=this.render(i.checkboxTemplate).attr("for",e.attr("id")).insertAfter(e),this.initialize()}},{checkboxTemplate:function(t){return'<label class="'+t("checkbox")+'"></label>'}}),l.InputRadio=l.Input.extend({name:"InputRadio",version:"2.1.0",constructor:function(e,i){this.element=e=t(e),i=this.setOptions(i,e),this.wrapper=this._buildWrapper(),this.input=this.render(i.radioTemplate).attr("for",e.attr("id")).insertAfter(e),this.initialize()}},{radioTemplate:function(t){return'<label class="'+t("radio")+'"></label>'}}),l.InputSelect=l.Input.extend({name:"InputSelect",version:"2.1.0",dropdown:null,index:0,multiple:!1,constructor:function(e,i){this.element=e=t(e),i=this.setOptions(i,e),this.multiple=e.prop("multiple"),this.multiple&&i["native"]||(this.wrapper=this._buildWrapper(),this.input=this._buildButton(),this.addEvent("change","element","onChange"),i["native"]||(this.addEvents([["blur","element","hide"],["clickout","dropdown","hide"],["click","input","onToggle"]]),this.multiple||this.addEvent("keydown","window","onCycle"),this.dropdown=this._buildDropdown(),this.element.css("z-index",1)),this.initialize(),this.element.change())},hide:function(){this.dropdown.is(":shown")&&(this.fireEvent("hiding"),this.input.removeClass("is-active"),this.dropdown.conceal(),this.fireEvent("hidden"))},show:function(){this.fireEvent("showing"),this.options.hideOpened&&t(this.ns("options","select")).each(function(){t(this).siblings("select").toolkit("inputSelect","hide")}),this.input.addClass("is-active"),this.dropdown.reveal(),this.fireEvent("shown")},_buildButton:function(){var t=this.options,e=this.render(t.selectTemplate).find(this.ns("arrow","select")).html(this.render(t.arrowTemplate)).end().find(this.ns("label","select")).html(l.messages.loading).end().css("min-width",this.element.width()).insertAfter(this.element);return this.element.css("min-height",e.outerHeight()),e},_buildDropdown:function(){var e=this.element,i=this.options,s=this._buildOption.bind(this),n=this.render.bind(this),o=n(i.optionsTemplate).attr("role","listbox").aria("multiselectable",this.multiple),a=t("<ul/>"),r=0,h=this;return this.dropdown=o,e.children().each(function(){var e=t(this);"optgroup"===e.prop("tagName").toLowerCase()?(0===r&&(i.hideFirst=!1),a.append(n(i.headingTemplate).text(e.attr("label"))),e.children().each(function(){var i=t(this);e.prop("disabled")&&i.prop("disabled",!0),i.prop("selected")&&(h.index=r),a.append(s(i,r)),r++})):(e.prop("selected")&&(h.index=r),a.append(s(e,r)),r++)}),i.hideSelected&&!i.multiple&&o.addClass("hide-selected"),i.hideFirst&&o.addClass("hide-first"),this.multiple&&o.addClass("is-multiple"),this.wrapper.append(o.append(a)),o},_buildOption:function(e,i){var s,n=this.element,o=this.dropdown,a=this.options,r=e.prop("selected"),h="is-active",l=t("<li/>"),d=e.text();r&&l.addClass(h),(s=this.readValue(e,a.getDescription))&&(d+=this.render(a.descTemplate).html(s).toString());var c=t("<a/>",{html:d,href:"javascript:;",role:"option"}).aria("selected",r);if(this.options.copyClasses&&this.copyClasses(e,l),l.append(c),e.prop("disabled"))return l.addClass("is-disabled"),c.aria("disabled",!0),l;if(this.multiple)c.click(function(){var i=t(this),s=!1;e.prop("selected")?i.parent().removeClass(h):(s=!0,i.parent().addClass(h)),e.prop("selected",s),i.aria("selected",s),n.change()});else{var u=this;c.click(function(){o.find("li").removeClass(h).end().find("a").aria("selected",!1),t(this).aria("selected",!0).parent().addClass(h),u.hide(),u.index=i,n.val(e.val()),n.change()})}return l},_loop:function(e,i,s){var n=this.options.hideFirst;for(e+=i;"undefined"===t.type(s[e])||s[e].disabled||0===e&&n;)e+=i,e>=s.length?e=0:0>e&&(e=s.length-1);return e},onChange:function(e){var i=t(e.target),s=i.find("option"),n=this.options,o=[],a=[],r=this;if(s.each(function(){this.selected&&(o.push(this),a.push(r.readValue(this,n.getOptionLabel)||this.textContent))}),this.multiple){var h=this.readValue(i,n.getDefaultLabel),l=n.multipleFormat,d=a.length;if(!a.length&&h)a=h;else if("count"===l)a=n.countMessage.replace("{count}",d).replace("{total}",s.length);else if("list"===l){var c=n.listLimit;a=a.splice(0,c).join(", "),d>c&&(a+=" ...")}}else a=a.join(", ");i.parent().find(this.ns("label","select")).text(a),this.fireEvent("change",[i.val(),o])},onCycle:function(e){if(this.dropdown.is(":shown")&&t.inArray(e.keyCode,[38,40,13,27])>=0){e.preventDefault();var i=this.element.find("option"),s=this.dropdown.find("a"),n="is-active",o=this.index;switch(e.keyCode){case 13:case 27:return void this.hide();case 38:o=this._loop(o,-1,i);break;case 40:o=this._loop(o,1,i)}i.prop("selected",!1),i[o].selected=!0,s.parent().removeClass(n),s.eq(o).parent().addClass(n),this.index=o,this.element.change()}},onToggle:function(){this.element.prop("disabled")||(this.dropdown.is(":shown")?this.hide():this.show())}},{"native":l.isTouch,multipleFormat:"count",countMessage:"{count} of {total} selected",listLimit:3,hideOpened:!0,hideFirst:!1,hideSelected:!1,getDefaultLabel:"title",getOptionLabel:"title",getDescription:"data-description",selectTemplate:function(t){return'<div class="'+t("select")+'" data-select><div class="'+t("select","arrow")+'" data-select-arrow></div><div class="'+t("select","label")+'" data-select-label></div></div>'},arrowTemplate:'<span class="caret-down"></span>',optionsTemplate:function(t){return'<div class="'+t("drop")+" "+t("drop","","down")+" "+t("select","options")+'" data-select-options></div>'},headingTemplate:function(t){return'<li class="'+t("drop","heading")+'"></li>'},descTemplate:function(t){return'<span class="'+t("drop","desc")+'"></span>'}}),l.createPlugin("input",function(t){return new l.Input(this,t)}),l.createPlugin("inputRadio",function(t){return new l.InputRadio(this,t)}),l.createPlugin("inputCheckbox",function(t){return new l.InputCheckbox(this,t)}),l.createPlugin("inputSelect",function(t){return new l.InputSelect(this,t)}),l.LazyLoad=l.Component.extend({name:"LazyLoad",version:"2.1.0",container:t(e),items:[],loaded:0,timer:null,constructor:function(e,i){e=t(e),i=this.setOptions(i,e),this.items=e.find(this.options.lazyClass),"auto"===e.css("overflow")&&(this.container=e);var s=t.throttle(this.load.bind(this),i.throttle);this.addEvents([["scroll","container",s],["resize","window",s],["ready","document","onReady"]]),this.initialize()},destructor:function(){clearTimeout(this.timer),this.loadAll()},inViewport:function(i){i=t(i);var s=this.container,n=this.options.threshold,o=s.height(),a=s.width(),r=s.scrollTop(),h=s.scrollLeft(),l=i.offset(),d=l.left,c=l.top;if(s[0]!==e){var u=s.offset();d-=u.left,c-=u.top}return i.is(":visible")&&c>=r-n&&r+o+n>=c&&d>=h-n&&h+a+n>=d},load:function(){return this.loaded>=this.items.length?void this.shutdown():(this.fireEvent("loading"),this.items.each(function(t,e){e&&this.inViewport(e)&&this.show(e,t)}.bind(this)),void this.fireEvent("loaded"))},loadAll:function(){this.loaded>=this.items.length||(this.fireEvent("loadAll"),this.items.each(function(t,e){this.show(e,t)}.bind(this)))},show:function(e,i){e=t(e),this.fireEvent("showing",[e]),this.element=e.removeClass(this.options.lazyClass.substr(1)),e.find("img").each(function(){var e,i=t(this);l.isRetina&&(e=i.data("src-retina")),e||(e=i.data("src")),e&&i.attr("src",e)}),this.items.splice(i,1,null),this.loaded++,this.fireEvent("shown",[e])},shutdown:function(){this.enabled&&(this.disable(),this.fireEvent("shutdown"))},onReady:function(){this.load(),this.options.forceLoad&&(this.timer=setTimeout(this.loadAll.bind(this),this.options.delay))}},{forceLoad:!1,delay:1e4,threshold:150,throttle:50,lazyClass:".lazy-load"}),l.createPlugin("lazyLoad",function(t){return new l.LazyLoad(this,t)}),l.Mask=l.Component.extend({name:"Mask",version:"2.0.0",mask:null,message:null,constructor:function(t,e){if(t=this.setElement(t),e=this.setOptions(e,t),!t.is("body")){t.addClass("is-maskable");var i=t.css("position");i&&"static"!==i||t.css("position","relative")}var s=t.find("> "+this.ns());s.length||(s=this.render(e.template)),this.setMask(s),e.selector&&this.addEvent("click","document","toggle",e.selector),this.initialize()},destructor:function(){this.mask.remove(),this.element.removeClass("is-maskable").removeClass("is-masked").css("position","")},hide:function(){this.fireEvent("hiding"),this.mask.conceal(),this.element.removeClass("is-masked"),this.fireEvent("hidden")},setMask:function(t){var e,i=this.options;t.addClass("hide").appendTo(this.element),this.element.is("body")&&t.css("position","fixed"),i.revealOnClick&&t.click(this.hide.bind(this)),this.mask=t,e=t.find(this.ns("message")),!e.length&&i.messageContent&&(e=this.render(i.messageTemplate).html(i.messageContent).appendTo(t)),this.message=e},show:function(){this.fireEvent("showing"),this.mask.reveal(),this.element.addClass("is-masked"),this.fireEvent("shown")},toggle:function(){this.mask.is(":shown")?this.hide():this.show()}},{selector:"",revealOnClick:!1,messageContent:"",template:function(t){return'<div class="'+t("mask")+'" data-mask></div>'},messageTemplate:function(t){return'<div class="'+t("mask","message")+'" data-mask-message></div>'}}),l.createPlugin("mask",function(t){return new l.Mask(this,t)}),t.debounce=function(t,e){var i;return function(){var s=this,n=arguments;clearTimeout(i),i=setTimeout(function(){i=null,t.apply(s,n)},e||150)}},l.Matrix=l.Component.extend({name:"Matrix",version:"2.0.0",colCount:0,colHeights:[],colWidth:0,items:[],images:[],matrix:[],wrapperWidth:0,constructor:function(e,i){this.setElement(e),this.setOptions(i,this.element),this.addEvent("horizontalresize","window",t.debounce(this.onResize.bind(this))),this.initialize(),this.refresh()},destructor:function(){this.element.removeAttr("style"),this.items.removeAttr("style")},append:function(e){e=t(e).addClass("hide").appendTo(this.element),this.fireEvent("appending",[e]),this.refresh()},prepend:function(e){e=t(e).addClass("hide").prependTo(this.element),this.fireEvent("prepending",[e]),this.refresh()},refresh:function(){this.items=this.element.find("> li").each(function(){var e=t(this);e.cache("matrix-column-width",e.outerWidth())}),this.options.defer?this._deferRender():this.render()},remove:function(e){e=t(e),this.fireEvent("removing",[e]),this.items.filter(e).remove(),this.refresh()},render:function(){this._calculateColumns(),this.fireEvent("rendering");var t=this.element,e=this.items;e.length?this.colCount<=1?(t.removeAttr("style").addClass("no-columns"),e.removeAttr("style")):(t.removeClass("no-columns"),this._organizeItems(),this._positionItems()):t.removeAttr("style"),this.fireEvent("rendered")},_calculateColumns:function(){var t,e=this.element.outerWidth(),i=this.options.width,s=this.options.gutter,n=Math.max(Math.floor(e/i),1),o=n*(i+s)-s;n>1&&(o>e?(t=o-e,i-=t/n):e>o&&(t=e-o,i+=t/n)),this.wrapperWidth=e,this.colWidth=i,this.colCount=n},_deferRender:function(){var e=[];this.images=this.element.find("img").each(function(i,s){if(!s.complete){var n=s.src,o=t.Deferred();s.onload=o.resolve,s.onerror=s.onabort=o.reject,s.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",s.src=n,e.push(o.promise())}}),t.when.apply(t,e).always(this.render.bind(this))},_organizeItems:function(){var t,e,i,s=this.items.length;this.matrix=[];for(var n=0;s>n;n++)if(t=this.items.eq(n),i=t.data("matrix-column-width"),e=Math.max(Math.round(i/this.colWidth),1),e>this.colCount&&(e=this.colCount),this.matrix.push({item:t,span:e}),e>1)for(var o=1;e>o;o++)this.matrix&&this.matrix.push({item:t,span:!1})},_positionItems:function(){var t,e,i,s,n,o,a=this.options.gutter,r=this.matrix,h=this.options.rtl?"right":"left",l=[],d=0,c=0,u={margin:0,position:"absolute"};for(i=0;i<this.colCount;i++)l.push(0);for(i=0,s=r.length;s>i;i++){for(t=r[i],e=t.span,c=-1,n=0;n<this.colCount;n++)(-1===c||l[n]<c)&&(c=l[n],d=n);if((d>=this.colCount||e+d>this.colCount)&&(d=0),e){for(o=0,n=0;e>n;n++)l[d+n]>o&&(o=l[d+n]);for(u.top=o,u[h]=(this.colWidth+a)*d,u.width=(this.colWidth+a)*e-a,t.item.css(u).reveal(),n=0;e>n;n++)l[d+n]=t.item.outerHeight()+a+o}this.colHeights[d]=l[d],d++}this.element.css("height",Math.max.apply(Math,l))},onResize:function(){this.refresh()}},{width:200,gutter:20,rtl:l.isRTL,defer:!0}),l.createPlugin("matrix",function(t){return new l.Matrix(this,t)}),l.Modal=l.TemplateComponent.extend({name:"Modal",version:"2.1.0",blackout:null,constructor:function(e,i){this.nodes=t(e),i=this.setOptions(i),this.element=this.createElement().attr("role","dialog").aria("labelledby",this.id("title")).aria("describedby",this.id("content")),i.fullScreen&&this.element.addClass("is-fullscreen"),i.blackout&&(this.blackout=l.Blackout.instance()),this.addEvents([["keydown","window","onKeydown"],["click","document","onShow","{selector}"],["click","element","hide",this.ns("close")],["click","element","onSubmit",this.ns("submit")]]),i.clickout&&this.addEvent("click","element","onHide"),this.initialize()},hide:function(){this.fireEvent("hiding"),this.element.conceal(),this.blackout&&this.blackout.hide(),this.options.stopScroll&&t("body").removeClass("no-scroll"),this.fireEvent("hidden")},position:function(i){if(i!==!0){this.blackout&&this.blackout.hideLoader(),this.fireEvent("showing");var s=this.element.find(this.ns("content"));s.html(i),this.fireEvent("load",[i]),this.element.reveal(),this.options.fullScreen&&s.css("min-height",t(e).height()),this.fireEvent("shown")}},show:function(e,i){e&&(this.node=e=t(e),i||(i=this.readValue(e,this.readOption(e,"getContent"))||e.attr("href"))),this.blackout&&!this.element.is(":shown")&&this.blackout.show(),this.options.stopScroll&&t("body").addClass("no-scroll"),this.loadContent(i)},submit:function(){var t=this.element.find("form:first");if(t){this.fireEvent("submit",[t]);var i={url:t.attr("action"),type:(t.attr("method")||"post").toUpperCase()};e.FormData?(i.processData=!1,i.contentType=!1,i.data=new FormData(t[0])):i.data=t.serialize(),this.requestData(i)}},onHide:function(e){var i=this.element;("click"!==e.type||t(e.target).is(i))&&(e.preventDefault(),i.is(":shown")&&!i.hasClass("is-loading")&&this.hide())},onKeydown:function(t){27===t.keyCode&&this.element.is(":shown")&&this.hide()},onSubmit:function(t){t.preventDefault(),this.submit()}},{animation:"fade",blackout:!0,fullScreen:!1,stopScroll:!0,clickout:!0,getContent:"data-modal",template:function(t){return'<div class="'+t("modal")+'"><div class="'+t("modal","outer")+'"><div class="'+t("modal","inner")+'" data-modal-content></div><button class="'+t("modal","close")+'" data-modal-close><span class="x"></span></button></div></div>'}}),l.createPlugin("modal",function(t){return new l.Modal(this,t)},!0),l.OffCanvas=l.Component.extend({name:"OffCanvas",version:"2.0.0",container:null,primary:null,secondary:null,side:"left",opposite:"right",_loaded:!1,constructor:function(t,e){t=this.setElement(t).attr("role","complementary").conceal(),e=this.setOptions(e,t);var i=e.animation;l.isTouch&&"squish"===i&&(e.animation=i="push"),"on-top"!==i&&"squish"!==i&&(e.hideOthers=!0),this.container=t.parent().addClass(i),this.primary=t.siblings("[data-offcanvas-content]").attr("role","main"),this.secondary=t.siblings("[data-offcanvas-sidebar]"),this.side=t.data("offcanvas-sidebar")||"left",this.opposite="left"===this.side?"right":"left",this.addEvents([["ready","document","onReady"],["resize","window","onResize"]]),e.swipe&&this.addEvents("left"===this.side?[["swipeleft","element","hide"],["swiperight","container","onSwipe"]]:[["swipeleft","container","onSwipe"],["swiperight","element","hide"]]),e.selector&&this.addEvent("click","document","toggle",e.selector),this.initialize()},destructor:function(){this.hide()},hide:function(){this.fireEvent("hiding"),this.container.removeClass("move-"+this.opposite),this.element.conceal().removeClass("is-expanded").aria("expanded",!1),this.options.stopScroll&&t("body").removeClass("no-scroll"),this.fireEvent("hidden")},show:function(){var e=this.options;e.hideOthers&&this.secondary.each(function(){var e=t(this);e.hasClass("is-expanded")&&e.toolkit("offCanvas","hide")}),this.fireEvent("showing"),this.container.addClass("move-"+this.opposite),this.element.reveal().addClass("is-expanded").aria("expanded",!0),e.stopScroll&&t("body").addClass("no-scroll"),this.fireEvent("shown")},toggle:function(){this.element.hasClass("is-expanded")?this.hide():this.show()},onReady:function(){if(this.options.openOnLoad&&!this._loaded){var t=this.element,e=this.primary,i="no-transition";t.addClass(i),e.addClass(i),this.show(),setTimeout(function(){t.removeClass(i),e.removeClass(i)},15),this._loaded=!0}},onResize:function(){this.fireEvent("resize")},onSwipe:function(e){e.preventDefault();var i=t(e.target),s="[data-offcanvas-sidebar]";i.is(s)||i.parents(s).length||this.show()}},{selector:"",animation:"push",openOnLoad:!1,hideOthers:!0,stopScroll:!0,swipe:l.isTouch}),l.createPlugin("offCanvas",function(t){return new l.OffCanvas(this,t)}),l.Pin=l.Component.extend({name:"Pin",version:"2.0.0",active:!0,elementHeight:null,elementTop:0,parentHeight:null,parentTop:null,viewport:{},constructor:function(e,i){e=this.setElement(e),i=this.setOptions(i,e),e.attr("role","complementary").addClass(i.animation),this.elementTop=parseInt(e.css("top"),10);var s=i.throttle;this.addEvents([["scroll","window",t.throttle(this.onScroll.bind(this),s)],["resize","window",t.throttle(this.onResize.bind(this),s)],["ready","document","onResize"]]),this.initialize()},destructor:function(){this.active=!1,setTimeout(function(){this.element.removeAttr("style").removeClass("is-pinned")}.bind(this),15)},calculate:function(){var i=t(e),s=this.options,n=s.context?this.element.parents(s.context):this.element.parent();this.viewport={width:i.width(),height:i.height()},this.elementHeight=this.element.outerHeight(!0),this.parentHeight=n.height(),this.parentTop=n.offset().top,this.active=s.lock&&this.elementHeight>=this.viewport.height?!1:this.element.is(":visible")&&this.parentHeight>this.elementHeight},pin:function(){var i=this.options;if(i.calculate&&this.calculate(),this.active){var s=this.elementHeight,n=this.elementTop,o=this.parentHeight,a=this.parentTop,r=t(e).scrollTop(),h={},l=i.xOffset,d=0;if(a>r)return void this.element.removeAttr("style").removeClass("is-pinned");var c=r+s,u=o+a;i.fixed?c>=u?(d="auto",h.position="absolute",h.bottom=0):(d=i.yOffset,h.position="fixed",h.bottom="auto"):(h.position="absolute",d+=c>=u?o-s:r-a+i.yOffset,n&&n>d&&(d=n)),h[i.location]=l,h.top=d,this.element.css(h).addClass("is-pinned")}},onResize:function(){this.calculate(),this.pin(),this.fireEvent("resize")},onScroll:function(){this.pin(),this.fireEvent("scroll")}},{location:"right",xOffset:0,yOffset:0,throttle:50,fixed:!1,calculate:!1,lock:!0}),l.createPlugin("pin",function(t){return new l.Pin(this,t)}),t.fn.positionTo=function(i,s,n,o){if(!i)return this;var a,r=n||{left:0,top:0},h=0,l=0,d=this.outerHeight(!0),c=this.outerWidth(!0),u=t(e),p=u.width(),f=u.height(),m=u.scrollTop();s.preventDefault?a={left:s.pageX,top:s.pageY}:(a=s.offset(),h=s.outerHeight(),l=s.outerWidth()),r.left+=a.left,r.top+=a.top;var v=r.top,g=r.left,w=i.split("-"),b={y:w[0],x:w[1]};return"top"===b.y?v-=d:"bottom"===b.y?v+=h:"center"===b.y&&(v-=Math.round(d/2-h/2)),"left"===b.x?g-=c:"right"===b.x?g+=l:"center"===b.x&&(g-=Math.round(c/2-l/2)),0>g?g=0:g+c>p&&(g=p-c),0>v?v=0:v+d>f+m&&(v=a.top-d),o&&("center"===b.y&&("left"===b.x?g-=15:"right"===b.x&&(g+=15)),"center"===b.x&&("top"===b.y?v-=10:"bottom"===b.y&&(v+=10))),this.css({left:g,top:v})},l.Tooltip=l.CompositeComponent.extend({name:"Tooltip",version:"2.1.3",constructor:function(e,i){this.nodes=t(e),i=this.setOptions(i),this.createWrapper(),"title"===i.getTitle&&(i.getTitle="data-"+this.keyName+"-title",this.nodes.each(function(e,s){t(s).attr(i.getTitle,t(s).attr("title")).removeAttr("title")})),this.addEvents([["{mode}","document","onShowToggle","{selector}"],["resize","window",t.debounce(this.onHide.bind(this))]]),"click"===i.mode?this.addEvent("clickout","document","hide"):this.addEvent("mouseleave","document","hide","{selector}"),this.initialize()},hide:function(){this.fireEvent("hiding"),this.hideElements(),this.node&&this.node.removeAttr("aria-describedby").removeClass("is-active"),this.fireEvent("hidden")},position:function(t,e){if(t!==!0){this.fireEvent("showing");var i=this.node.aria("describedby",this.id()),s=this.inheritOptions(this.options,i),n=this.loadElement(i);if(e=e||this.readValue(i,s.getTitle),n.find(this.ns("header")).html(e).toggle(Boolean(e)&&s.showTitle).end().find(this.ns("content")).html(t),this.fireEvent("load",[t,e]),s.follow){var o=this.onFollow.bind(this);i.off("mousemove",o).on("mousemove",o)}else n.reveal().positionTo(s.position,i,{left:s.xOffset,top:s.yOffset});this.fireEvent("shown")}},show:function(e,i){this.node=e=t(e).addClass("is-active"),this.loadElement(e,function(t){t.addClass(this.readOption(e,"position")).attr("role","tooltip")}),this.loadContent(i||this.readValue(e,this.readOption(e,"getContent")))},onFollow:function(t){t.preventDefault();var e=this.options;this.element.reveal().positionTo(e.position,t,{left:e.xOffset,top:e.yOffset},!0)},onHide:function(){if(this.node){var t=this.loadElement(this.node);t.is(":shown")&&this.hide()}},onRequestBefore:function(t){l.Component.prototype.onRequestBefore.call(this,t),this.options.showLoading&&this.position(l.messages.loading)}},{mode:"hover",animation:"fade",follow:!1,position:"top-center",showLoading:!0,showTitle:!0,getTitle:"title",getContent:"data-tooltip",mouseThrottle:50,xOffset:0,yOffset:0,wrapperClass:function(t){return t("tooltips")},template:function(t){return'<div class="'+t("tooltip")+'"><div class="'+t("tooltip","inner")+'"><div class="'+t("tooltip","head")+'" data-tooltip-header></div><div class="'+t("tooltip","body")+'" data-tooltip-content></div></div><div class="'+t("tooltip","arrow")+'"></div></div>'}}),l.createPlugin("tooltip",function(t){return new l.Tooltip(this,t)},!0),l.Popover=l.Tooltip.extend({name:"Popover",version:"2.1.3",constructor:function(t,e){e=e||{},e.mode="click",e.follow=!1,l.Tooltip.prototype.constructor.call(this,t,e)}},{getContent:"data-popover",wrapperClass:function(t){return t("popovers")},template:function(t){return'<div class="'+t("popover")+'"><div class="'+t("popover","inner")+'"><div class="'+t("popover","head")+'" data-popover-header></div><div class="'+t("popover","body")+'" data-popover-content></div></div><div class="'+t("popover","arrow")+'"></div></div>'}}),l.createPlugin("popover",function(t){return new l.Popover(this,t)},!0),l.Showcase=l.TemplateComponent.extend({name:"Showcase",version:"2.1.0",animating:!1,blackout:null,caption:null,data:[],index:-1,items:[],tabs:[],constructor:function(e,i){var s;i=this.setOptions(i),this.element=s=this.createElement(),this.nodes=t(e),this.items=s.find(this.ns("items")),this.tabs=s.find(this.ns("tabs")),this.caption=s.find(this.ns("caption")),i.blackout&&(this.blackout=l.Blackout.instance()),this.addEvents([["keydown","window","onKeydown"],["click","document","onShow","{selector}"],["click","element","hide",this.ns("close")],["click","element","next",this.ns("next")],["click","element","prev",this.ns("prev")],["click","element","onJump",this.ns("tabs")+" a"]]),i.clickout&&this.addEvents([["clickout","document","onHide","{selector}"],["clickout","element","onHide"]]),i.swipe&&this.addEvents([["swipeleft","element","next"],["swiperight","element","prev"]]),this.addEvent(l.transitionEnd,"element",function(t){t.stopPropagation()},this.ns("items")),this.initialize()},hide:function(){this.fireEvent("hiding"),this.blackout&&this.blackout.hide(),this.options.stopScroll&&t("body").removeClass("no-scroll"),this.element.conceal().removeClass("is-single"),this.items.removeAttr("style").children("li").conceal(!0),this.fireEvent("hidden")},jump:function(e){if(!this.animating&&(e=t.bound(e,this.data.length),e!==this.index)){var i=this,s=this.element,n=this.caption,o=this.items,a=o.children("li"),r=a.eq(e),h=this.data,d=h[e],c=t.Deferred();if(this.fireEvent("jumping",[this.index]),this.tabs.find("a").removeClass("is-active").eq(e).addClass("is-active"),a.conceal(!0),n.conceal(!0),s.addClass("is-loading").aria("busy",!0).reveal(),this.animating=!0,c.always(function(t,e){o.transitionend(function(){n.html(d.title).reveal(!0),r.reveal(!0),i.position(),i.animating=!1}),i._resize(t,e),s.removeClass("is-loading").aria("busy",!1),r.data("width",t).data("height",e)}),c.fail(function(){s.addClass("has-failed"),r.html(l.messages.error)}),r.data("width"))c.resolve(r.data("width"),r.data("height"));else{var u=new Image;u.src=d.image,u.onerror=function(){c.reject(150,150)},u.onload=function(){c.resolve(this.width,this.height),r.append(u)}}this.blackout&&this.blackout.hideLoader(),this.index=e,this.fireEvent("jumped",[e])}},next:function(){this.jump(this.index+1)},position:function(){this.fireEvent("showing"),this.blackout&&this.blackout.hideLoader(),this.element.reveal(),this.fireEvent("shown")},prev:function(){this.jump(this.index-1)},show:function(e){this.node=e=t(e),this.index=-1;var i=this.inheritOptions(this.options,e),s=this.readValue,n=s(e,i.getCategory),o=[],a=0;if(n)for(var r,h=0,l=0;r=this.nodes[h];h++)s(r,i.getCategory)===n&&(e.is(r)&&(a=l),o.push({title:s(r,i.getTitle),category:n,image:s(r,i.getImage)}),l++);else o.push({title:s(e,i.getTitle),category:n,image:s(e,i.getImage)});this.blackout&&this.blackout.show(),i.stopScroll&&t("body").addClass("no-scroll"),this._buildItems(o),this.jump(a)},_buildItems:function(e){this.data=e,this.items.empty(),this.tabs.empty();for(var i,s,n,o=0;n=e[o];o++)i=t("<li/>"),i.appendTo(this.items),s=t("<a/>").attr("href","javascript:;").data("showcase-index",o),i=t("<li/>"),i.appendTo(this.tabs).append(s);e.length<=1&&this.element.addClass("is-single"),this.fireEvent("load",[e])},_resize:function(i,s){var n,o,a=2*this.options.gutter,r=t(e).width()-a,h=t(e).height()-a;i>r&&(n=i/s,o=i-r,i=r,s-=Math.round(o/n)),s>h&&(n=s/i,o=s-h,i-=Math.round(o/n),s=h),this.items.css({width:i,height:s})},onHide:function(t){t.preventDefault();var e=this.element;e.is(":shown")&&!e.hasClass("is-loading")&&this.hide()},onJump:function(e){e.preventDefault(),this.jump(t(e.target).data("showcase-index")||0)},onKeydown:function(e){if(this.element.is(":shown"))switch(t.inArray(e.keyCode,[37,38,39,40])>=0&&e.preventDefault(),e.keyCode){case 27:this.hide();break;case 37:this.prev();break;case 38:this.jump(0);break;case 39:this.next();break;case 40:this.jump(-1)}}},{blackout:!0,stopScroll:!0,clickout:!0,swipe:l.isTouch,gutter:50,getCategory:"data-showcase",getImage:"href",getTitle:"title",template:function(t){return'<div class="'+t("showcase")+'"><div class="'+t("showcase","inner")+'"><ul class="'+t("showcase","items")+'" data-showcase-items></ul><ol class="'+t("showcase","tabs")+' bullets" data-showcase-tabs></ol><button class="'+t("showcase","prev")+'" data-showcase-prev></button><button class="'+t("showcase","next")+'" data-showcase-next></button></div><button class="'+t("showcase","close")+'" data-showcase-close><span class="x"></span></button><div class="'+t("showcase","caption")+'" data-showcase-caption></div></div>'}}),l.createPlugin("showcase",function(t){return new l.Showcase(this,t)},!0),l.Stalker=l.Component.extend({name:"Stalker",version:"2.0.0",container:t(e),targets:[],markers:[],offsets:[],constructor:function(e,i){if(e=this.setElement(e),i=this.setOptions(i),!i.target||!i.marker)throw new Error("A marker and target is required");"auto"===e.css("overflow")&&(this.container=e),this.addEvents([["scroll","container",t.throttle(this.onScroll.bind(this),i.throttle)],["ready","document","onScroll"]]),this.initialize(),this.refresh()},destructor:function(){this.targets.removeClass("is-active"),this.markers.removeClass("is-marked")},activate:function(t){this.stalk(t,"activate")},deactivate:function(t){this.stalk(t,"deactivate")},stalk:function(e,i){if(e=t(e),!("activate"===i&&e.hasClass("is-stalked")||"deactivate"===i&&!e.hasClass("is-stalked"))){var s,n,o,a=this.options,r=a.targetBy,h=a.markBy,l=this.targets.filter(function(){return t(this).attr(r).replace("#","")===e.attr(h)});"activate"===i?(s="activating",n="activated",o="addClass"):(s="deactivating",n="deactivated",o="removeClass"),this.fireEvent(s,[e,l]),e[o]("is-stalked"),l[o]("is-active"),this.fireEvent(n,[e,l])}},refresh:function(){var i,s=this.container.is(e),n=this.element.offset().top,o=[];"auto"!==this.element.css("overflow")||this.element.is("body")||(this.element[0].scrollTop=0),this.targets=t(this.options.target),this.markers=t(this.options.marker).each(function(e,a){i=t(a).offset(),s||(i.top-=n),o.push(i)}),this.offsets=o},onScroll:function(){var e=this.container.scrollTop(),i=this.offsets,s=this.options.onlyWithin,n=this.options.threshold;this.markers.each(function(o,a){a=t(a);var r=i[o],h=r.top-n,l=r.top+a.height()+n;s&&e>=h&&l>=e||!s&&e>=h?this.activate(a):this.deactivate(a)}.bind(this)),this.fireEvent("scroll")}},{target:"",targetBy:"href",marker:"",markBy:"id",threshold:50,throttle:50,onlyWithin:!0,applyToParent:!0}),l.createPlugin("stalker",function(t){return new l.Stalker(this,t)}),l.Tab=l.Component.extend({name:"Tab",version:"2.0.0",index:0,nav:null,sections:[],tabs:[],constructor:function(e,i){var s,n,o=this;e=this.setElement(e),i=this.setOptions(i,e),i.cookie||(i.cookie=e.attr("id")),this.sections=s=e.find(this.ns("section")).each(function(e,i){i=t(i),i.attr("role","tabpanel").attr("id",i.attr("id")||o.id("section",e)).aria("labelledby",o.id("tab",e)).conceal()}),this.nav=e.find(this.ns("nav")).attr("role","tablist"),this.tabs=n=this.nav.find("a").each(function(e){t(this).data("tab-index",e).attr({role:"tab",id:o.id("tab",e)}).aria({controls:s.eq(e).attr("id"),selected:!1,expanded:!1}).removeClass("is-active")}),this.addEvent("{mode}","element","onShow",this.ns("nav")+" a"),"click"!==i.mode&&i.preventDefault&&this.addEvent("click","element",function(t){t.preventDefault()},this.ns("nav")+" a"),this.initialize();var a=null;i.persistState&&(i.cookie&&t.cookie&&(a=t.cookie("toolkit.tab."+i.cookie)),null===a&&i.loadFragment&&location.hash&&(a=n.filter(function(){return t(this).attr("href")===location.hash}).eq(0).data("tab-index"))),n[a]||(a=i.defaultIndex),this.jump(a)},destructor:function(){this.jump(0)},hide:function(){this.fireEvent("hiding"),this.sections.conceal(),this.fireEvent("hidden")},jump:function(e){this.show(this.tabs[t.bound(e,this.tabs.length)])},show:function(e){e=t(e);var i=e.data("tab-index"),s=this.sections.eq(i),n=this.options,o=this.readValue(e,this.readOption(e,"getUrl"));this.fireEvent("showing",[this.index]),"javascript"!==o.substr(0,10)&&"#"!==o.substr(0,1)&&this.loadContent(o,{section:s}),this.tabs.aria("toggled",!1).removeClass("is-active"),i===this.index&&n.collapsible?s.is(":shown")?s.conceal():(e.aria("toggled",!0).addClass("is-active"),s.reveal()):(this.hide(),e.aria("toggled",!0).addClass("is-active"),s.reveal()),n.persistState&&t.cookie&&t.cookie("toolkit.tab."+n.cookie,i,{expires:n.cookieDuration}),this.index=i,this.node=e,this.fireEvent("shown",[i])},onRequestBefore:function(t){t.params.section.html(l.messages.loading).addClass("is-loading").aria("busy",!0)},onRequestDone:function(t,e,i){i.cache&&(this.cache[i.url]=t),this.fireEvent("load",[t]),i.params.section.html(t).removeClass("is-loading").aria("busy",!1)},onRequestFail:function(t){t.params.section.html(l.messages.error).removeClass("is-loading").addClass("has-failed").aria("busy",!1)},onShow:function(t){(this.options.preventDefault||"#"!==t.currentTarget.getAttribute("href").substr(0,1))&&t.preventDefault(),this.show(t.currentTarget)}},{mode:"click",collapsible:!1,defaultIndex:0,persistState:!1,preventDefault:!0,loadFragment:!0,cookie:null,cookieDuration:30,getUrl:"href"}),l.createPlugin("tab",function(t){return new l.Tab(this,t)}),l.Toast=l.CompositeComponent.extend({name:"Toast",version:"2.1.0",constructor:function(e,i){this.nodes=e=t(e),i=this.setOptions(i,e),this.createWrapper().addClass(i.position).attr("role","log").aria({relevant:"additions",hidden:"false"}),this.initialize()},create:function(e,i){i=t.extend({},this.options,i||{});var s=this,n=this.render(i.template).addClass(i.animation).attr("role","note").html(e).conceal().prependTo(this.wrapper);this.fireEvent("create",[n]),setTimeout(function(){s.show(n)},15),i.duration&&setTimeout(function(){s.hide(n)},i.duration+15)},hide:function(e){e=t(e),this.fireEvent("hiding",[e]),e.transitionend(function(){e.remove(),this.fireEvent("hidden")}.bind(this)).conceal()},show:function(e){e=t(e),this.fireEvent("showing",[e]),e.reveal(),this.fireEvent("shown",[e])}},{position:"bottom-left",animation:"slide-up",duration:5e3,wrapperClass:function(t){return t("toasts")},template:function(t){return'<div class="'+t("toast")+'"></div>'}}),l.createPlugin("toast",function(t){return new l.Toast(this,t)}),l.TypeAhead=l.TemplateComponent.extend({name:"TypeAhead",version:"2.1.3",index:-1,input:null,items:[],shadow:null,term:"",timer:null,wrapper:null,constructor:function(e,i){if(e=t(e),"input"!==e.prop("tagName").toLowerCase())throw new Error("TypeAhead must be initialized on an input field");var s=this;if(i=this.setOptions(i,e),this.element=this.createElement().attr("role","listbox").aria("multiselectable",!1),this.input=e,t.each({sorter:"sort",matcher:"match",builder:"build"},function(e,n){if(i[e]!==!1){var o;o=null===i[e]||"function"!==t.type(i[e])?s[n]:i[e],i[e]=o.bind(s)}}),i.prefetch&&"string"===t.type(i.source)){var n=i.source;t.getJSON(n,i.query,function(t){s.cache[n]=t})}i.shadow&&(this.wrapper=this.render(this.options.shadowTemplate),this.shadow=this.input.clone().addClass("is-shadow").removeAttr("id").prop("readonly",!0).aria("readonly",!0),this.input.addClass("not-shadow").replaceWith(this.wrapper),this.wrapper.append(this.shadow).append(this.input)),e.attr({autocomplete:"off",autocapitalize:"off",autocorrect:"off",spellcheck:"false",role:"combobox"}).aria({autocomplete:"list",owns:this.element.attr("id"),expanded:!1}),this.addEvents([["keyup","input","onLookup"],["keydown","input","onCycle"],["clickout","element","hide"],["resize","window",t.debounce(this.onHide.bind(this))]]),this.initialize()},destructor:function(){this.shadow&&(this.shadow.parent().replaceWith(this.input),this.input.removeClass("not-shadow"))},build:function(e){var i=t("<a/>",{href:"javascript:;",role:"option","aria-selected":"false"});return i.append(this.render(this.options.titleTemplate).html(this.highlight(e.title))),e.description&&i.append(this.render(this.options.descTemplate).html(e.description)),i},hide:function(){this.fireEvent("hiding"),this.shadow&&this.shadow.val(""),this.input.aria("expanded",!1),this.element.conceal(),this.fireEvent("hidden")},highlight:function(t){for(var e,i=this.term.replace(/[\-\[\]\{\}()*+?.,\\^$|#]/g,"\\$&").split(" "),s=this.options,n=function(t){return this.render(s.highlightTemplate).html(t).toString()}.bind(this),o=0;e=i[o];o++)t=t.replace(new RegExp(e,"ig"),n);return t},lookup:function(t){this.term=t,this.timer=setTimeout(this.onFind.bind(this),this.options.throttle)},match:function(t,e){return t.title.toLowerCase().indexOf(e.toLowerCase())>=0},position:function(){if(!this.items.length)return void this.hide();this.fireEvent("showing");var t=this.input.offset();this.element.css("top",t.top+this.input.outerHeight()).css(l.isRTL?"right":"left",t.left).reveal(),this.input.aria("expanded",!0),this.fireEvent("shown")},rewind:function(){this.index=-1,this.element.find("li").removeClass("is-active")},select:function(t,e){this.index=t;var i=this.element.find("li");if(i.removeClass("is-active").find("a").aria("selected",!1),t>=0){if(this.items[t]){var s=this.items[t];i.eq(t).addClass("is-active").find("a").aria("selected",!0),this.input.val(s.title),this.fireEvent(e||"select",[s,t])}}else this.input.val(this.term),this.fireEvent("reset")},sort:function(t){return t.sort(function(t,e){return t.title.localeCompare(e.title)})},source:function(e){if(!this.term.length||!e.length)return void this.hide();var i,s=this.options,n=this.term,o={_empty_:[]},a=t("<ul/>");this.items=[],this.index=-1,"function"===t.type(s.sorter)&&(e=s.sorter(e)),"function"===t.type(s.matcher)&&(e=e.filter(function(t){return s.matcher(t,n)}));for(var r=0;i=e[r];r++)i.category?(o[i.category]||(o[i.category]=[]),o[i.category].push(i)):o._empty_.push(i);var h=[],l=0;t.each(o,function(e,n){var o=[];"_empty_"!==e&&(h.push(null),o.push(this.render(s.headingTemplate).append(t("<span/>",{text:e}))));for(var r,d=0;(i=n[d])&&!(l>=s.itemLimit);d++)r=s.builder(i),r.on({mouseover:this.rewind.bind(this),click:t.proxy(this.onSelect,this,h.length)}),o.push(t("<li/>").append(r)),h.push(i),l++;a.append(o)}.bind(this)),this.element.empty().append(a),this.items=h,this.cache[n.toLowerCase()]=h.filter(function(t){return null!==t}),this.fireEvent("load"),this._shadow(),this.position()},_shadow:function(){if(this.shadow){var t=this.input.val(),e=t.toLowerCase(),i="";if(this.cache[e]&&this.cache[e][0]){var s=this.cache[e][0].title;0===s.toLowerCase().indexOf(e)&&(i=t+s.substr(t.length,s.length-t.length))}this.shadow.val(i)}},onCycle:function(t){var e=this.items,i=Math.min(this.options.itemLimit,Math.max(0,e.length)),s="cycle";if(i&&this.element.is(":shown")){switch(t.keyCode){case 38:this.index-=e[this.index-1]?1:2,this.index<0&&(this.index=i);break;case 40:this.index+=e[this.index+1]?1:2,this.index>=i&&(this.index=-1);break;case 9:t.preventDefault();for(var n=0;!this.items[n];)n++;s="select",this.index=n,this.hide();break;case 13:t.preventDefault(),s="select",this.hide();break;case 27:this.index=-1,this.hide();break;default:return}this.shadow&&this.shadow.val(""),this.select(this.index,s)}},onFind:function(){var e=this.term,i=this.options,s=t.type(i.source);if(this.cache[e.toLowerCase()])this.source(this.cache[e.toLowerCase()]);else if("string"===s){var n=i.source,o=this.cache[n];if(o)this.source(o);else{var a=i.query;a.term=e,t.getJSON(n,a,this.source.bind(this))}}else if("array"===s)this.source(i.source);else{if("function"!==s)throw new Error("Invalid TypeAhead source type");var r=i.source.call(this);r&&this.source(r)}},onLookup:function(e){if(!(t.inArray(e.keyCode,[38,40,27,9,13])>=0)){clearTimeout(this.timer);var i=this.input.val().trim();i.length<this.options.minLength?(this.fireEvent("reset"),this.hide()):(this._shadow(),this.lookup(i))}},onSelect:function(t){this.select(t),this.hide()}},{source:[],minLength:1,itemLimit:15,throttle:250,prefetch:!1,shadow:!1,query:{},template:function(t){return'<div class="'+t("type-ahead")+'"></div>'},shadowTemplate:function(t){return'<div class="'+t("type-ahead","shadow")+'"></div>'},titleTemplate:function(t){return'<span class="'+t("type-ahead","title")+'"></span>'},descTemplate:function(t){return'<span class="'+t("type-ahead","desc")+'"></span>'},highlightTemplate:function(t){return'<mark class="'+t("type-ahead","highlight")+'"></mark>'},headingTemplate:function(t){return'<li class="'+t("type-ahead","heading")+'"></li>'},sorter:null,matcher:null,builder:null}),l.createPlugin("typeAhead",function(t){return new l.TypeAhead(this,t)}),t.event.special.verticalresize=function(){function i(e){var i=s.height();i!==n&&(n=i,t(e.target).trigger("verticalresize"))}var s=t(e),n=s.height();return{setup:function(){s.on("resize",i)},teardown:function(){s.off("resize",i)}}}()}(jQuery,window,document);