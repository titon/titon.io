/*! Titon Toolkit v2.0.0 | BSD-3 License | titon.io */
!function(t,e,i){"use strict";function s(e,i,s){return"undefined"===t.type(s)?e.getAttribute("aria-"+i):(s===!0?s="true":s===!1&&(s="false"),void e.setAttribute("aria-"+i,s))}var n=!!("ontouchstart"in e||e.DocumentTouch&&i instanceof DocumentTouch),o=e.devicePixelRatio>1,a=function(){for(var t="transition WebkitTransition MozTransition OTransition msTransition".split(" "),e=i.createElement("div").style,s=0;s<t.length;s++)if(t[s]in e)return t[s];return!1}(),h=function(){var t={WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd otransitionend"};return t[a]||"transitionend"}();t.fn.cache=function(e,i){var s=this.data(e),n=t.type(s);return"undefined"!==n&&"null"!==n?s:("function"===t.type(i)&&(i=i.call(this)),this.data(e,i),i)};var r={version:"2.0.0",build:"i3937naa",vendor:"",aria:!0,debug:!1,messages:{loading:"Loading...",error:"An error has occurred!"},hasTransition:a,isTouch:n,isRetina:o,transitionEnd:h,cache:{},create:function(e,i,s){var n=e;t.fn[n]&&(n="toolkit"+n.charAt(0).toUpperCase()+n.slice(1)),t.fn[n]=s?function(){var s=r.cache[e+":"+this.selector]=i.apply(this,arguments);return this.each(function(){t(this).cache("toolkit."+e,s)})}:function(){var s=arguments;return this.each(function(){t(this).cache("toolkit."+e,i.apply(this,s))})}}};e.Toolkit=r,r.Class=function(){};var l=!1;r.Class.extend=function(e,i){function s(){if(!l){for(var e in this){var i=this[e],n=t.type(i);"array"===n?this[e]=i.slice(0):"object"===n&&(this[e]=t.extend(!0,{},i))}this.uid=s.count+=1;var a=this.name;a&&(this.cssClass=a.replace(/[A-Z]/g,function(t){return"-"+t.charAt(0).toLowerCase()}).slice(1),this.keyName=a.charAt(0).toLowerCase()+a.slice(1)),o&&o.apply(this,arguments)}}l=!0;var n=new this;l=!1,t.extend(n,e);var o=n.constructor;return s.prototype=n,s.prototype.constructor=o||s,s.options=t.extend(!0,{},this.options||{},i||{}),s.extend=this.extend,s.count=0,s},r.Base=r.Class.extend({name:"Base",version:"2.0.0",cache:{},enabled:!1,options:{},runtime:{},__events:[],__hooks:{},addEvent:function(e,i,s,n){var o=this.options;"{mode}"===e&&(e=o.mode),"{selector}"===n&&(n=this.nodes?this.nodes.selector:""),"string"===t.type(s)&&(s=this[s].bind(this)),this.__events.push([e,i,s,n])},addEvents:function(e){t.each(e,function(t,e){this.addEvent.apply(this,e)}.bind(this))},addHook:function(t,e){var i=this.__hooks[t]||[];i.push(e),this.__hooks[t]=i},addHooks:function(e,i){t.each(i,function(t,i){this.addHook(e,i)}.bind(this))},bindEvents:function(s){var n,o,a,h,r=this,l=t(e),d=t(i);t.each(this.__events,function(e,i){n=i[0],o=i[1],a=i[2],h=i[3],r[o]?o=r[o]:"window"===o?o=l:"document"===o&&(o=d),"ready"===n?d.ready(a):h?t(o)[s](n,h,a):t(o)[s](n,a)})},destroy:function(){this.fireEvent("destroying"),this.destructor&&this.destructor(),this.disable(),this.fireEvent("destroyed")},disable:function(){this.enabled&&this.bindEvents("off"),this.enabled=!1},enable:function(){this.enabled||this.bindEvents("on"),this.enabled=!0},fireEvent:function(e,i){var s=this.options.debug||r.debug;s&&(console.log(this.name+"#"+this.uid,(new Date).getMilliseconds(),e,i||[]),"verbose"===s&&console.dir(this));var n=this.__hooks[e];n&&t.each(n,function(t,e){e.apply(this,i||[])}.bind(this))},initialize:function(){this.enable(),this.fireEvent("init")},removeHook:function(e,i){if(!i)return void delete this.__hooks[e];var s=this.__hooks[e];s&&t.each(s,function(t,e){e===i&&(s=s.splice(t,1))})},setOptions:function(i){var s,n=t.extend(!0,{},r[this.name].options,i||{});n.responsive&&e.matchMedia&&t.each(n.responsive,function(e,i){matchMedia(i.breakpoint).matches&&t.extend(n,i)});for(s in n)s.match(/^on[A-Z]/)&&(this.addHook(s.substr(2).toLowerCase(),n[s]),delete n[s]);return n}},{cache:!0,debug:!1}),t.fn.aria=function(e,i){return r.aria?("toggled"===e&&(e={expanded:i,selected:i},i=null),t.access(this,s,e,i,arguments.length>1)):this},t.fn.transitionend=function(e,i){if(arguments.length>0){this.one(h,null,e,i);var s=this.css("transition-duration");("0s"===s||"undefined"===t.type(s))&&this.trigger(h)}else this.trigger(h);return this},t.fn.conceal=function(e){return this.hasClass("show")&&!e&&this.transitionend(function(){t(this).hide()}),this.removeClass("show").addClass("hide").aria("hidden",!0)},t.fn.reveal=function(t){return t||this.show(),setTimeout(function(){this.removeClass("hide").addClass("show").aria("hidden",!1)}.bind(this),1),this},t.fn.toolkit=function(e,i,s){var n=this.selector,o=this.data("toolkit."+e)||r.cache[e+":"+n]||null;return o?(i&&o[i]&&o[i].apply(o,t.makeArray(s)),o):null},r.Component=r.Base.extend({name:"Component",version:"2.0.0",created:!1,element:null,elements:[],namespace:"",node:null,nodes:[],constructor:function(t,e){this.element=this.setElement(t),this.options=this.setOptions(e,this.element)},createElement:function(){var e,i=this.options;if(i.templateFrom&&(e=t(i.templateFrom)),e&&e.length||!i.template||(e=t(i.template).hide().addClass("hide").appendTo("body")),!e)throw new Error("Failed to create template element");return i.className&&e.addClass(i.className),i.animation&&e.addClass(i.animation),this.created=!0,e.attr("id",this.id())},destroy:function(){var t=this.keyName;this.nodes&&this.nodes.length?(this.nodes.removeData("toolkit."+t),delete r.cache[t+":"+this.nodes.selector]):this.element&&this.element.length&&this.element.removeData("toolkit."+t),r.Base.prototype.destroy.call(this),this.created&&(this.hide(),this.element.remove())},fireEvent:function(e,i){r.Base.prototype.fireEvent.call(this,e,i);var s=this.element,n=this.node,o=t.Event(e+".toolkit."+this.keyName);o.context=this,s&&s.length&&s.trigger(o,i||[]),n&&n.length&&n.trigger(o,i||[])},hide:function(){this.fireEvent("hiding"),this.element.conceal(),this.fireEvent("hidden")},id:function(){var e=t.makeArray(arguments);return e.unshift("toolkit",this.cssClass,this.uid),e.join("-")},inheritOptions:function(e,i){var s,n,o={};for(s in e)"context"!==s&&"template"!==s&&(n=i.data((this.keyName+"-"+s).toLowerCase()),"undefined"!==t.type(n)&&(o[s]=n));return t.extend(!0,{},e,o)},loadContent:function(e,i){var s=!1;e.match(/^#[a-z0-9_\-\.:]+$/i)?e=t(e).html():(e.match(/^([a-z]+:)?\/\//)||e.match(/^\/[\w\-\.\/]+/i))&&(s=!0),this.cache[e]?this.position(this.cache[e]):s?this.requestData(e,i):this.position(e)},ns:function(t,e){var i="data-"+(e||this.keyName);return t&&(i+="-"+t),this.namespace&&(i+='="'+this.namespace+'"'),"["+i+"]"},position:function(t){this.fireEvent("load",[t])},process:function(t){if(t.callback){for(var i=t.callback.split("."),s=e,n=s,o=0;o<i.length;o++)n=s,s=s[i[o]];s.call(n,t)}this.fireEvent("process",[t]),this.hide()},readOption:function(e,i){var s=e.data((this.keyName+"-"+i).toLowerCase());return"undefined"===t.type(s)&&(s=this.options[i]),s},readValue:function(e,i){return i?(e=t(e),"function"===t.type(i)?i.call(this,e):e.attr(i)):null},requestData:function(e,i){var s={};return"object"===t.type(this.options.ajax)&&(s=this.options.ajax),"string"===t.type(e)?s.url=e:t.extend(s,e),s.context=this,s.beforeSend=function(t){t.url=s.url,t.cache=(!s.type||"GET"===s.type.toUpperCase())&&this.options.cache,t.settings=s,t.params=i||{},this.onRequestBefore.call(this,t)},t.ajax(s).done(this.onRequestDone).fail(this.onRequestFail)},setElement:function(e){return e=t(e),this.namespace=e.data(this.keyName)||"",e},setOptions:function(e,i){if(i){var s=this.readOption(i,"group");s&&e.groups[s]&&t.extend(e,e.groups[s])}var n=r.Base.prototype.setOptions.call(this,e);return i&&(n=this.inheritOptions(n,i)),n.mode&&"hover"===n.mode&&(n.mode=r.isTouch?"click":"mouseenter"),n},show:function(e){e&&(this.node=t(e)),this.fireEvent("showing"),this.element.reveal(),this.fireEvent("shown")},onRequestBefore:function(t){this.cache[t.url]=!0,this.element.addClass("is-loading").aria("busy",!0)},onRequestDone:function(t,e,i){var s=i.url;this.element.removeClass("is-loading").aria("busy",!1),delete this.cache[s],i.getResponseHeader("Content-Type").indexOf("text/html")>=0?(i.cache&&(this.cache[s]=t),this.position(t)):this.process(t)},onRequestFail:function(t){delete this.cache[t.url],this.element.removeClass("is-loading").addClass("has-failed").aria("busy",!1),this.position(r.messages.error)},onShow:function(t){t.preventDefault(),this.show(t.currentTarget)},onShowToggle:function(e){var i=t(e.currentTarget),s=this.node&&i[0]===this.node[0];if(this.element&&this.element.is(":shown")){if(r.isTouch?s&&"a"===this.node.prop("tagName").toLowerCase()||e.preventDefault():e.preventDefault(),s)return void("click"===this.options.mode&&this.hide())}else e.preventDefault();this.show(i)}},{ajax:{},context:null,className:"",template:"",templateFrom:""}),t.bound=function(t,e,i){return i=i||0,t>=e?t=i:i>t&&(t=e-1),t},t.expr[":"].shown=function(e){return"hidden"!==t(e).css("visibility")},t.event.special.horizontalresize=function(){function i(e){var i=s.width();i!==n&&(n=i,t(e.target).trigger("horizontalresize"))}var s=t(e),n=s.width();return{setup:function(){s.on("resize",i)},teardown:function(){s.off("resize",i)}}}(),r.Accordion=r.Component.extend({name:"Accordion",version:"2.0.0",headers:[],index:0,sections:[],constructor:function(e,i){var s=this;this.element=e=this.setElement(e).attr("role","tablist"),this.options=i=this.setOptions(i,e),this.headers=e.find(this.ns("header")).each(function(e){t(this).data("accordion-index",e).attr({role:"tab",id:s.id("header",e)}).aria({controls:s.id("section",e),selected:!1,expanded:!1})}),this.sections=e.find(this.ns("section")).each(function(e){t(this).attr({role:"tabpanel",id:s.id("section",e)}).aria("labelledby",s.id("header",e)).conceal()}),this.addEvents([["horizontalresize","window",t.debounce(this.calculate.bind(this))],["{mode}","element","onShow",this.ns("header")]]),this.initialize(),this.calculate(),this.jump(i.defaultIndex)},destructor:function(){this.headers.addClass("is-active").attr("toggled",!0),this.sections.attr("style","").reveal()},calculate:function(e){"function"!==t.type(e)&&(e=function(t){return t.outerHeight()}),this.sections.each(function(){var i=t(this),s=i.hasClass("hide")?"hide":"show",n=i.css("max-height");i.addClass("no-transition").removeClass(s).css("max-height","");var o=e.call(this,i);i.addClass(s).css("max-height",n).removeClass("no-transition"),i.data("accordion-height",o),i.hasClass("show")&&i.css("max-height",o)})},jump:function(e){this.show(this.headers[t.bound(e,this.headers.length)])},show:function(e){e=t(e);var i=this.options,s=e.next(),n=e.data("accordion-index"),o=parseInt(s.data("accordion-height"),10),a=this.node&&this.node.is(e);if(this.fireEvent("showing",[s,e,this.index]),"click"===i.mode&&(i.multiple||i.collapsible&&a))s.is(":shown")&&this.node?(s.css("max-height",0).conceal(!0),e.aria("toggled",!1).removeClass("is-active")):(s.css("max-height",o).reveal(!0),e.aria("toggled",!0).addClass("is-active"));else{if(a)return;this.sections.css("max-height",0).conceal(!0),s.css("max-height",o).reveal(!0),this.headers.aria("toggled",!1).removeClass("is-active"),e.aria("toggled",!0).addClass("is-active")}this.index=n,this.node=e,this.fireEvent("shown",[s,e,n])}},{mode:"click",defaultIndex:0,multiple:!1,collapsible:!1}),r.create("accordion",function(t){return new r.Accordion(this,t)});var d=r.vendor,c=null;r.Blackout=r.Component.extend({name:"Blackout",version:"2.0.0",count:0,loader:null,message:null,constructor:function(e){this.options=e=this.setOptions(e),this.element=this.createElement(),this.loader=t(e.loaderTemplate).appendTo(this.element),this.message=this.loader.find(this.ns("message","loader")),e.showLoading&&this.message.html(r.messages.loading),this.initialize()},destructor:function(){this.element.remove(),c=null},hide:function(){this.fireEvent("hiding");var t=this.count-1;0>=t?(this.count=0,this.element.conceal()):this.count=t,this.hideLoader(),this.fireEvent("hidden",[0>=t])},hideLoader:function(){this.loader.hide()},show:function(){this.fireEvent("showing");var t=!1;this.count++,1===this.count&&(this.element.reveal(),t=!0),this.showLoader(),this.fireEvent("shown",[t])},showLoader:function(){this.loader.show()}},{showLoading:!0,template:'<div class="'+d+'blackout"></div>',templateFrom:"#toolkit-blackout-1",loaderTemplate:'<div class="'+d+'loader bar-wave"><span></span><span></span><span></span><span></span><span></span><div class="'+d+'loader-message" data-loader-message></div></div>'}),r.Blackout.instance=function(t){return c?c:c=new r.Blackout(t)},t.event.special.swipe=function(){function e(t){var e=t.originalEvent.changedTouches?t.originalEvent.changedTouches[0]:t;return{time:(new Date).getTime(),x:e.pageX,y:e.pageY}}function i(e,i,s,n){if(e&&i){var o,a=t.event.special.swipe,h=i.x-e.x,l=i.y-e.y;if(i.time-e.time<=a.duration){if(r(h)>=a.distance&&r(l)<=a.restraint)o=0>h?"left":"right";else{if(!(r(l)>=a.distance&&r(h)<=a.restraint))return;o=0>l?"up":"down"}var d={target:n,swipestart:e,swipestop:i};s.trigger(t.Event("swipe",d)).trigger(t.Event("swipe"+o,d))}}}var s=n?"touchstart":"mousedown",o=n?"touchmove":"mousemove",a=n?"touchend":"mouseup",h=!1,r=Math.abs;return{duration:1e3,distance:50,restraint:75,setup:function(){function l(t){var i=e(t);r(c.x-i.x)>r(c.y-i.y)&&t.preventDefault()}function d(){c=u=null,h=!1,p.off(o,l)}var c,u,p=t(this);p.on(s,function(t){n||"img"!==t.target.tagName.toLowerCase()||t.preventDefault(),h||(c=e(t),u=t.target,h=!0,n&&p.on(o,l))}),p.on(a,function(t){i(c,e(t),p,u),d()}),p.on("touchcancel",d)},teardown:function(){t(this).off(s).off(o).off(a).off("touchcancel")}}}(),t.each("swipe swipeleft swiperight swipeup swipedown".split(" "),function(e,i){"swipe"!==i&&(t.event.special[i]={setup:function(){t(this).on("swipe",t.noop)},teardown:function(){t(this).off("swipe")}})}),t.throttle=function(t,e){if(!e)return t;var i=!1;return function(){var s=this,n=arguments;i||(i=!0,setTimeout(function(){t.apply(s,n),i=!1},e))}},r.Carousel=r.Component.extend({name:"Carousel",version:"2.0.0",animating:!1,container:null,index:-1,items:[],stopped:!1,tabs:[],timer:null,_dimension:null,_position:null,_size:0,_resetTo:null,constructor:function(e,i){var s,n=this;this.element=e=this.setElement(e),this.options=i=this.setOptions(i,e),e.aria("live",i.autoCycle?"assertive":"off").addClass(i.animation),this.container=e.find(this.ns("items")).addClass("no-transition"),this.items=s=this.container.find("> li").each(function(e){t(this).attr({role:"tabpanel",id:n.id("item",e)}).data("carousel-index",e).aria("hidden",e>0)}),this.tabs=e.find(this.ns("tabs")).attr("role","tablist").find("a").each(function(e){t(this).data("carousel-index",e).attr({role:"tab",id:n.id("tab",e)}).aria({controls:n.id("item",e),selected:!1,expanded:!1})}),this.addEvents([["resize","window",t.throttle(this.calculate.bind(this),50)],["keydown","window","onKeydown"],["click","element","onJump",this.ns("tabs")+" a"],["click","element","next",this.ns("next")],["click","element","prev",this.ns("prev")],["click","element","start",this.ns("start")],["click","element","stop",this.ns("stop")]]),i.swipe&&this.addEvents([["swipeleft","element","next"],["swipeup","element","next"],["swiperight","element","prev"],["swipedown","element","prev"]]),i.stopOnHover&&this.addEvents([["mouseenter","element","stop"],["mouseleave","element","start"]]),this.initialize(),this._setupState(),this._buildClones(),this.calculate(),this.start(),this.jump(i.defaultIndex)},destructor:function(){this.stop(),this.jump(0),this.container.transitionend(function(){t(this).addClass("no-transition").css("left",0).find("li.is-cloned").remove()})},calculate:function(){if("fade"!==this.options.animation){var t,e=this._dimension;this._size=t=this.element[e]()/this.options.itemsToShow;var i=this.items.css(e,t);this.container.css(e,t*i.length)}},jump:function(t){if(!this.animating){var e=this._getIndex(t),i=e[0],s=e[1];s!==this.index&&(this.fireEvent("jumping",[this.index]),this._updateTabs(s),this._updateItems(i),this._beforeCycle(),"fade"===this.options.animation?this.items.conceal(!0).eq(s).transitionend(this._afterCycle.bind(this)).reveal(!0):this.container.transitionend(this._afterCycle.bind(this)).css(this._position,-(i*this._size)),this.index=s,this.reset(),this.fireEvent("jumped",[s]))}},next:function(){this.jump(this.index+this.options.itemsToCycle)},prev:function(){this.jump(this.index-this.options.itemsToCycle)},reset:function(){this.options.autoCycle&&(clearInterval(this.timer),this.timer=setInterval(this.onCycle.bind(this),this.options.duration))},start:function(){this.element.removeClass("is-stopped"),this.stopped=!1,this.fireEvent("start")},stop:function(){this.element.addClass("is-stopped"),this.stopped=!0,clearInterval(this.timer),this.fireEvent("stop")},_afterCycle:function(){this.animating=!1;var t=this.container,e=this._resetTo;null!==e&&(t.addClass("no-transition").css(this._position,-(e*this._size)),this._updateItems(e),this._resetTo=null),setTimeout(function(){t.removeClass("no-transition"),this.fireEvent("cycled")}.bind(this),15)},_beforeCycle:function(){this.animating=!0,this.fireEvent("cycling")},_buildClones:function(){var t=this.options,e=this.items,i=this.container,s=t.itemsToShow;t.infinite&&(e.slice(0,s).clone().addClass("is-cloned").removeAttr("id").removeAttr("role").appendTo(i),e.slice(-s).clone().addClass("is-cloned").removeAttr("id").removeAttr("role").prependTo(i),this.items=i.find("> li"))},_getIndex:function(t){var e,i,s=this.options,n=s.itemsToShow;if(t=parseInt(t,10),s.infinite){var o=this.items.length,a=o-2*n;t>=a?(this._resetTo=0+n,i=o-n,e=0):-n>=t?(this._resetTo=a,i=0,e=a-n):(this._resetTo=null,e=t,i=t+n)}else{var h=this.element.removeClass("no-next no-prev"),r=this.items.length-n;t>=r?(t=r,s.loop?t===this.index&&this.index===r&&(t=0):h.addClass("no-next")):0>=t&&(t=0,s.loop?t===this.index&&0===this.index&&(t=r):h.addClass("no-prev")),i=e=t}return[i,e]},_setupState:function(){var t=this.options,e=t.animation;t.itemsToCycle>t.itemsToShow&&(t.itemsToCycle=t.itemsToShow),"fade"===e&&(t.itemsToShow=t.itemsToCycle=1,t.infinite=!1),"slide-up"===e?(this._dimension="height",this._position="top"):"slide"===e&&(this._dimension="width",this._position="left")},_updateItems:function(t){this.items.removeClass("is-active").aria("hidden",!0).slice(t,t+this.options.itemsToShow).addClass("is-active").aria("hidden",!1)},_updateTabs:function(e){var i=this.options.itemsToShow,s=this.items.length,n=e+i,o=t([]),a=this.tabs.removeClass("is-active").aria("toggled",!1);a.length&&(this.options.infinite&&(s-=2*i),e>=0?o=o.add(a.slice(e,n)):(o=o.add(a.slice(0,n)),o=o.add(a.slice(e))),n>s&&(o=o.add(a.slice(0,n-s))),o.addClass("is-active").aria("toggled",!0))},onCycle:function(){this.stopped||(this.options.reverse?this.prev():this.next())},onJump:function(e){e.preventDefault(),this.jump(t(e.currentTarget).data("carousel-index")||0)},onKeydown:function(t){switch(t.keyCode){case 37:this.prev();break;case 38:this.jump(0);break;case 39:this.next();break;case 40:this.jump(-1);break;default:return}t.preventDefault()}},{animation:"slide",duration:5e3,autoCycle:!0,stopOnHover:!0,infinite:!0,loop:!0,reverse:!1,swipe:r.isTouch,itemsToShow:1,itemsToCycle:1,defaultIndex:0}),r.create("carousel",function(t){return new r.Carousel(this,t)}),t.event.special.clickout=function(){var e=[];return t(i).on(n?"touchend":"click",function(s){if(e.length){var n=!0,o=t(i),a=t(s.target);t.each(e,function(e,i){var h=t(i);return(n="string"===t.type(i)?!a.is(i)&&!h.has(s.target).length:!h.is(s.target)&&!h.has(s.target).length)?void(o=o.add(h)):!1}),n&&o.trigger("clickout",[s.target])}}),{add:function(s){var n=this;this===i&&(n=s.selector),-1===t.inArray(n,e)&&e.push(n)},remove:function(s){var n=this;this===i&&(n=s.selector),e=t.grep(e,function(t){return t!==n})}}}(),r.Drop=r.Component.extend({name:"Drop",version:"2.0.0",constructor:function(e,i){this.nodes=t(e),this.options=this.setOptions(i),this.addEvents([["clickout","document","hide",this.ns("menu")],["clickout","document","hide","{selector}"],["{mode}","document","onShow","{selector}"]]),this.initialize()},destructor:function(){this.hide(),t(this.ns("menu")).conceal()},hide:function(){var t=this.element;t&&t.is(":shown")&&(this.fireEvent("hiding"),t.conceal(),this.node.aria("toggled",!1).removeClass("is-active"),this.fireEvent("hidden",[t,this.node]))},show:function(e,i){this.fireEvent("showing"),this.element=e=t(e).reveal(),this.node=i=t(i).aria("toggled",!0).addClass("is-active"),this.fireEvent("shown",[e,i])},onShow:function(e){e.preventDefault();var i=t(e.currentTarget),s=this.options,n=this.readValue(i,s.getTarget);if(n&&"#"===n.substr(0,1)){s.hideOpened&&this.node&&!this.node.is(i)&&this.hide();var o=t(n);o.is(":shown")?(this.element=o,this.hide()):this.show(o,i)}}},{mode:"click",getTarget:"data-drop",hideOpened:!0}),r.create("drop",function(t){return new r.Drop(this,t)},!0),r.Flyout=r.Component.extend({name:"Flyout",version:"2.0.0",current:null,menus:{},data:[],dataMap:{},timers:{},constructor:function(e,i,s){this.nodes=t(e),this.options=s=this.setOptions(s),"click"===s.mode?this.addEvent("click","document","onShowToggle","{selector}"):this.addEvents([["mouseenter","document","onShowToggle","{selector}"],["mouseenter","document","onEnter","{selector}"],["mouseleave","document","onLeave","{selector}"]]),this.initialize(),i&&t.getJSON(i,this.load.bind(this))},destructor:function(){t.each(this.menus,function(t,e){e.remove()}),this.clearTimer("show"),this.clearTimer("hide")},clearTimer:function(t){clearTimeout(this.timers[t]),delete this.timers[t]},hide:function(){this.node&&this.node.removeClass("is-active"),this.isVisible()&&(this.fireEvent("hiding"),this.element.conceal(),this.fireEvent("hidden"),this.element=this.current=null)},isVisible:function(){return this.current&&this.menus[this.current]&&(this.element=this.menus[this.current]),this.element&&this.element.is(":shown")},load:function(t,e){if(e=e||0,0===e&&(this.data=t),t.url&&(this.dataMap[t.url]=t),t.children)for(var i=0,s=t.children.length;s>i;i++)this.load(t.children[i],e+1)},position:function(){var i=this.current,s=this.options;if(this.menus[i]){this.fireEvent("showing");var n=this.menus[i],o=n.outerHeight(),a=this.node.offset(),h=a.left+s.xOffset,r=a.top+s.yOffset+this.node.outerHeight(),l=t(e).height();r>l/2&&(r=a.top-s.yOffset-o),n.css({left:h,top:r}).reveal(),this.fireEvent("shown")}},show:function(e){var i=this._getTarget(e);this.current&&i!==this.current&&(this.hide(),this.startTimer("show",this.options.showDelay)),this.node=t(e),this._getMenu()&&(this.node.addClass("is-active"),"click"===this.options.mode&&this.position())},startTimer:function(t,e,i){this.clearTimer(t);var s;s="show"===t?this.position:this.hide,s&&(this.timers[t]=setTimeout(function(){s.apply(this,i||[])}.bind(this),e))},_buildMenu:function(e,i){if(!i.children||!i.children.length)return null;var s,n,o,a,h,r=this.options,l=t(r.template).attr("role","menu"),d=[],c=r.itemLimit;if(r.className&&l.addClass(r.className),e.is("body")?l.addClass("is-root"):l.aria("expanded",!1),c&&i.children.length>c)for(a=0,h=i.children.length;h>a;)d.push(i.children.slice(a,a+=c));else d.push(i.children);for(var u,p,m=0;u=d[m];m++){for(s=t("<ul/>"),a=0,h=u.length;h>a;a++)p=u[a],p.url?(n=t("<li/>"),o=t("<a/>",{text:p.title,href:p.url,role:"menuitem"}),t("<span/>").addClass(p.icon||"caret-right").prependTo(o)):(n=t(r.headingTemplate),o=t("<span/>",{text:p.title,role:"presentation"})),p.attributes&&o.attr(p.attributes),p.className&&n.addClass(p.className),n.append(o).appendTo(s),p.children&&p.children.length&&(this._buildMenu(n,p),n.addClass("has-children").aria("haspopup",!0).on("mouseenter",this.onPositionChild.bind(this,n)).on("mouseleave",this.onHideChild.bind(this,n)));l.append(s)}return l.appendTo(e).conceal(),"click"!==r.mode&&e.is("body")&&l.on({mouseenter:function(){this.clearTimer("hide")}.bind(this),mouseleave:function(){this.startTimer("hide",r.hideDelay)}.bind(this)}),l},_getMenu:function(){var e=this._getTarget();if(this.current=e,this.menus[e])return this.menus[e];if(this.dataMap[e]){var i=this._buildMenu(t("body"),this.dataMap[e]);return i?this.menus[e]=i:null}return null},_getTarget:function(e){return e=t(e||this.node),this.readValue(e,this.options.getUrl)||e.attr("href")},onEnter:function(){this.clearTimer("hide"),this.startTimer("show",this.options.showDelay)},onHideChild:function(e){e=t(e),e.removeClass("is-open"),e.children(this.ns("menu")).removeAttr("style").aria({expanded:!1,hidden:!1}).conceal(),this.fireEvent("hideChild",[e])},onLeave:function(){this.clearTimer("show"),this.startTimer("hide",this.options.showDelay)},onPositionChild:function(i){var s=i.children(this.ns("menu"));if(s){s.aria({expanded:!0,hidden:!0});var n=s.children();s.css("width",n.outerWidth()*n.length+"px");var o=t(e),a=o.height()+o.scrollTop(),h=o.width(),r=i.offset().top,l=i.outerHeight(),d=i.offset().left+i.outerWidth(),c=d+s.outerWidth();c>=h?s.addClass("push-left"):s.removeClass("push-left"),r>a/2?s.css("top","-"+(s.outerHeight()-l)+"px"):s.css("top",0),i.addClass("is-open"),s.reveal(),this.fireEvent("showChild",[i])}},onShowToggle:function(t){r.isTouch||(this.isVisible(),r.Component.prototype.onShowToggle.call(this,t))}},{mode:"hover",getUrl:"href",xOffset:0,yOffset:0,showDelay:350,hideDelay:1e3,itemLimit:15,template:'<div class="'+d+'flyout" data-flyout-menu></div>',headingTemplate:'<li class="'+d+'flyout-heading"></li>'}),r.create("flyout",function(t,e){return new r.Flyout(this,t,e)},!0),t.fn.toString=function(){return this.prop("outerHTML")},r.Input=r.Component.extend({name:"Input",version:"2.0.0",input:null,wrapper:null,constructor:function(t,e){this.element=t=this.setElement(t),this.options=e=this.setOptions(e,t),e.checkbox&&t.find(e.checkbox).inputCheckbox(e),e.radio&&t.find(e.radio).inputRadio(e),e.select&&t.find(e.select).inputSelect(e),this.initialize()},destructor:function(){var e=this.options,i=this.element;"Input"===this.name?(e.checkbox&&i.find(e.checkbox).each(function(){t(this).toolkit("inputCheckbox","destroy")}),e.radio&&i.find(e.radio).each(function(){t(this).toolkit("inputRadio","destroy")}),e.select&&i.find(e.select).each(function(){t(this).toolkit("inputSelect","destroy")})):this.wrapper&&(this.wrapper.replaceWith(i),i.removeAttr("style"))},copyClasses:function(e,i){var s=(t(e).attr("class")||"").replace(this.options.filterClasses,"").trim();s&&t(i).addClass(s)},_buildWrapper:function(){var e=this.element,i=t(this.options.template).insertBefore(e).append(e);return this.options.copyClasses&&this.copyClasses(e,i),i}},{copyClasses:!0,filterClasses:/\binput\b/,checkbox:"input:checkbox",radio:"input:radio",select:"select",template:'<div class="'+d+'custom-input"></div>'}),r.InputCheckbox=r.Input.extend({name:"InputCheckbox",version:"2.0.0",constructor:function(e,i){this.element=e=t(e),this.options=i=this.setOptions(i,e),this.wrapper=this._buildWrapper(),this.input=t(i.checkboxTemplate).attr("for",e.attr("id")).insertAfter(e),this.initialize()}},{checkboxTemplate:'<label class="'+d+'checkbox"></label>'}),r.InputRadio=r.Input.extend({name:"InputRadio",version:"2.0.0",constructor:function(e,i){this.element=e=t(e),this.options=i=this.setOptions(i,e),this.wrapper=this._buildWrapper(),this.input=t(i.radioTemplate).attr("for",e.attr("id")).insertAfter(e),this.initialize()}},{radioTemplate:'<label class="'+d+'radio"></label>'}),r.InputSelect=r.Input.extend({name:"InputSelect",version:"2.0.0",dropdown:null,index:0,multiple:!1,constructor:function(e,i){this.element=e=t(e),this.options=i=this.setOptions(i,e),this.multiple=e.prop("multiple"),this.multiple&&i.native||(this.wrapper=this._buildWrapper(),this.input=this._buildButton(),this.addEvent("change","element","onChange"),i.native||(this.addEvents([["blur","element","hide"],["clickout","dropdown","hide"],["click","input","onToggle"]]),this.multiple||this.addEvent("keydown","window","onCycle"),this.dropdown=this._buildDropdown(),this.element.css("z-index",1)),this.initialize(),this.element.change())},hide:function(){this.dropdown.is(":shown")&&(this.fireEvent("hiding"),this.input.removeClass("is-active"),this.dropdown.conceal(),this.fireEvent("hidden"))},show:function(){this.fireEvent("showing"),this.options.hideOpened&&t(this.ns("options","select")).each(function(){t(this).siblings("select").toolkit("inputSelect","hide")}),this.input.addClass("is-active"),this.dropdown.reveal(),this.fireEvent("shown")},_buildButton:function(){var e=this.options,i=t(e.selectTemplate).find(this.ns("arrow","select")).html(e.arrowTemplate).end().find(this.ns("label","select")).html(r.messages.loading).end().css("min-width",this.element.width()).insertAfter(this.element);return this.element.css("min-height",i.outerHeight()),i},_buildDropdown:function(){var e=this.element,i=this.options,s=this._buildOption.bind(this),n=t(i.optionsTemplate).attr("role","listbox").aria("multiselectable",this.multiple),o=t("<ul/>"),a=0,h=this;return this.dropdown=n,e.children().each(function(){var e=t(this);"optgroup"===e.prop("tagName").toLowerCase()?(0===a&&(i.hideFirst=!1),o.append(t(i.headingTemplate).text(e.attr("label"))),e.children().each(function(){var i=t(this);e.prop("disabled")&&i.prop("disabled",!0),i.prop("selected")&&(h.index=a),o.append(s(i,a)),a++})):(e.prop("selected")&&(h.index=a),o.append(s(e,a)),a++)}),i.hideSelected&&!i.multiple&&n.addClass("hide-selected"),i.hideFirst&&n.addClass("hide-first"),this.multiple&&n.addClass("is-multiple"),this.wrapper.append(n.append(o)),n},_buildOption:function(e,i){var s,n=this.element,o=this.dropdown,a=this.options,h=e.prop("selected"),r="is-active",l=t("<li/>"),d=e.text();h&&l.addClass(r),(s=this.readValue(e,a.getDescription))&&(d+=t(a.descTemplate).html(s).toString());var c=t("<a/>",{html:d,href:"javascript:;",role:"option"}).aria("selected",h);if(this.options.copyClasses&&this.copyClasses(e,l),l.append(c),e.prop("disabled"))return l.addClass("is-disabled"),c.aria("disabled",!0),l;if(this.multiple)c.click(function(){var i=t(this),s=!1;e.prop("selected")?i.parent().removeClass(r):(s=!0,i.parent().addClass(r)),e.prop("selected",s),i.aria("selected",s),n.change()});else{var u=this;c.click(function(){o.find("li").removeClass(r).end().find("a").aria("selected",!1),t(this).aria("selected",!0).parent().addClass(r),u.hide(),u.index=i,n.val(e.val()),n.change()})}return l},_loop:function(e,i,s){var n=this.options.hideFirst;for(e+=i;"undefined"===t.type(s[e])||s[e].disabled||0===e&&n;)e+=i,e>=s.length?e=0:0>e&&(e=s.length-1);return e},onChange:function(e){var i=t(e.target),s=i.find("option"),n=this.options,o=[],a=[],h=this;if(s.each(function(){this.selected&&(o.push(this),a.push(h.readValue(this,n.getOptionLabel)||this.textContent))}),this.multiple){var r=this.readValue(i,n.getDefaultLabel),l=n.multipleFormat,d=a.length;if(!a.length&&r)a=r;else if("count"===l)a=n.countMessage.replace("{count}",d).replace("{total}",s.length);else if("list"===l){var c=n.listLimit;a=a.splice(0,c).join(", "),d>c&&(a+=" ...")}}else a=a.join(", ");i.parent().find(this.ns("label","select")).text(a),this.fireEvent("change",[i.val(),o])},onCycle:function(e){if(this.dropdown.is(":shown")&&t.inArray(e.keyCode,[38,40,13,27])>=0){e.preventDefault();var i=this.element.find("option"),s=this.dropdown.find("a"),n="is-active",o=this.index;switch(e.keyCode){case 13:case 27:return void this.hide();case 38:o=this._loop(o,-1,i);break;case 40:o=this._loop(o,1,i)}i.prop("selected",!1),i[o].selected=!0,s.parent().removeClass(n),s.eq(o).parent().addClass(n),this.index=o,this.element.change()}},onToggle:function(){this.element.prop("disabled")||(this.dropdown.is(":shown")?this.hide():this.show())}},{"native":r.isTouch,multipleFormat:"count",countMessage:"{count} of {total} selected",listLimit:3,hideOpened:!0,hideFirst:!1,hideSelected:!1,getDefaultLabel:"title",getOptionLabel:"title",getDescription:"data-description",selectTemplate:'<div class="'+d+'select" data-select><div class="'+d+'select-arrow" data-select-arrow></div><div class="'+d+'select-label" data-select-label></div></div>',arrowTemplate:'<span class="caret-down"></span>',optionsTemplate:'<div class="'+d+"drop "+d+"drop--down "+d+'select-options" data-select-options></div>',headingTemplate:'<li class="'+d+'drop-heading"></li>',descTemplate:'<span class="'+d+'drop-desc"></span>'}),r.create("input",function(t){return new r.Input(this,t)}),r.create("inputRadio",function(t){return new r.InputRadio(this,t)}),r.create("inputCheckbox",function(t){return new r.InputCheckbox(this,t)}),r.create("inputSelect",function(t){return new r.InputSelect(this,t)}),r.LazyLoad=r.Component.extend({name:"LazyLoad",version:"2.0.0",container:t(e),loaded:0,timer:null,constructor:function(e,i){e=t(e),this.options=i=this.setOptions(i,e),this.elements=e.find(this.options.lazyClass),"auto"===e.css("overflow")&&(this.container=e);var s=t.throttle(this.load.bind(this),i.throttle);this.addEvents([["scroll","container",s],["resize","window",s],["ready","document","onReady"]]),this.initialize()},destructor:function(){clearTimeout(this.timer),this.loadAll()},inViewport:function(i){i=t(i);var s=this.container,n=this.options.threshold,o=s.height(),a=s.width(),h=s.scrollTop(),r=s.scrollLeft(),l=i.offset(),d=l.left,c=l.top;if(s[0]!==e){var u=s.offset();d-=u.left,c-=u.top}return i.is(":visible")&&c>=h-n&&h+o+n>=c&&d>=r-n&&r+a+n>=d},load:function(){return this.loaded>=this.elements.length?void this.shutdown():(this.fireEvent("loading"),this.elements.each(function(t,e){e&&this.inViewport(e)&&this.show(e,t)}.bind(this)),void this.fireEvent("loaded"))},loadAll:function(){this.loaded>=this.elements.length||(this.fireEvent("loadAll"),this.elements.each(function(t,e){this.show(e,t)}.bind(this)))},show:function(e,i){e=t(e),this.fireEvent("showing",[e]),e.removeClass(this.options.lazyClass.substr(1)),this.element=e,e.find("img").each(function(){var e,i=t(this);r.isRetina&&(e=i.data("src-retina")),e||(e=i.data("src")),e&&i.attr("src",e)}),this.elements.splice(i,1,null),this.loaded++,this.fireEvent("shown",[e])},shutdown:function(){this.enabled&&(this.disable(),this.fireEvent("shutdown"))},onReady:function(){this.load(),this.options.forceLoad&&(this.timer=setTimeout(this.loadAll.bind(this),this.options.delay))}},{forceLoad:!1,delay:1e4,threshold:150,throttle:50,lazyClass:".lazy-load"}),r.create("lazyLoad",function(t){return new r.LazyLoad(this,t)}),r.Mask=r.Component.extend({name:"Mask",version:"2.0.0",mask:null,message:null,constructor:function(e,i){if(this.element=e=this.setElement(e),this.options=i=this.setOptions(i,e),!e.is("body")){e.addClass("is-maskable");var s=e.css("position");s&&"static"!==s||e.css("position","relative")}var n=e.find("> "+this.ns());n.length||(n=t(i.template)),this.setMask(n),i.selector&&this.addEvent("click","document","toggle",i.selector),this.initialize()},destructor:function(){this.mask.remove(),this.element.removeClass("is-maskable").removeClass("is-masked").css("position","")},hide:function(){this.fireEvent("hiding"),this.mask.conceal(),this.element.removeClass("is-masked"),this.fireEvent("hidden")},setMask:function(e){var i,s=this.options;e.addClass("hide").appendTo(this.element),this.element.is("body")&&e.css("position","fixed"),s.revealOnClick&&e.click(this.hide.bind(this)),this.mask=e,i=e.find(this.ns("message")),!i.length&&s.messageContent&&(i=t(s.messageTemplate).html(s.messageContent).appendTo(e)),this.message=i},show:function(){this.fireEvent("showing"),this.mask.reveal(),this.element.addClass("is-masked"),this.fireEvent("shown")},toggle:function(){this.mask.is(":shown")?this.hide():this.show()}},{selector:"",revealOnClick:!1,messageContent:"",template:'<div class="'+d+'mask" data-mask></div>',messageTemplate:'<div class="'+d+'mask-message" data-mask-message></div>'}),r.create("mask",function(t){return new r.Mask(this,t)}),t.debounce=function(t,e){var i;return function(){var s=this,n=arguments;clearTimeout(i),i=setTimeout(function(){i=null,t.apply(s,n)},e||150)}},r.Matrix=r.Component.extend({name:"Matrix",version:"2.0.0",colCount:0,colHeights:[],colWidth:0,items:[],images:[],matrix:[],wrapperWidth:0,constructor:function(e,i){this.element=this.setElement(e),this.options=this.setOptions(i,this.element),this.addEvent("horizontalresize","window",t.debounce(this.onResize.bind(this))),this.initialize(),this.refresh()},destructor:function(){this.element.removeAttr("style"),this.items.removeAttr("style")},append:function(e){e=t(e).addClass("hide").appendTo(this.element),this.fireEvent("appending",[e]),this.refresh()},prepend:function(e){e=t(e).addClass("hide").prependTo(this.element),this.fireEvent("prepending",[e]),this.refresh()},refresh:function(){this.items=this.element.find("> li").each(function(){var e=t(this);e.cache("matrix-column-width",e.outerWidth())}),this.options.defer?this._deferRender():this.render()},remove:function(e){e=t(e),this.fireEvent("removing",[e]),this.items.filter(e).remove(),this.refresh()},render:function(){this._calculateColumns(),this.fireEvent("rendering");var t=this.element,e=this.items;e.length?this.colCount<=1?(t.removeAttr("style").addClass("no-columns"),e.removeAttr("style")):(t.removeClass("no-columns"),this._organizeItems(),this._positionItems()):t.removeAttr("style"),this.fireEvent("rendered")},_calculateColumns:function(){var t,e=this.element.outerWidth(),i=this.options.width,s=this.options.gutter,n=Math.max(Math.floor(e/i),1),o=n*(i+s)-s;n>1&&(o>e?(t=o-e,i-=t/n):e>o&&(t=e-o,i+=t/n)),this.wrapperWidth=e,this.colWidth=i,this.colCount=n},_deferRender:function(){var e=[];this.images=this.element.find("img").each(function(i,s){if(!s.complete){var n=s.src,o=t.Deferred();s.onload=o.resolve,s.onerror=s.onabort=o.reject,s.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",s.src=n,e.push(o.promise())}}),t.when.apply(t,e).always(this.render.bind(this))},_organizeItems:function(){var t,e,i,s=this.items.length;this.matrix=[];for(var n=0;s>n;n++)if(t=this.items.eq(n),i=t.data("matrix-column-width"),e=Math.max(Math.round(i/this.colWidth),1),e>this.colCount&&(e=this.colCount),this.matrix.push({item:t,span:e}),e>1)for(var o=1;e>o;o++)this.matrix&&this.matrix.push({item:t,span:!1})},_positionItems:function(){var t,e,i,s,n,o,a=this.options.gutter,h=this.matrix,r=this.options.rtl?"right":"left",l=[],d=0,c=0,u={margin:0,position:"absolute"};for(i=0;i<this.colCount;i++)l.push(0);for(i=0,s=h.length;s>i;i++){for(t=h[i],e=t.span,c=-1,n=0;n<this.colCount;n++)(-1===c||l[n]<c)&&(c=l[n],d=n);if((d>=this.colCount||e+d>this.colCount)&&(d=0),e){for(o=0,n=0;e>n;n++)l[d+n]>o&&(o=l[d+n]);for(u.top=o,u[r]=(this.colWidth+a)*d,u.width=(this.colWidth+a)*e-a,t.item.css(u).reveal(),n=0;e>n;n++)l[d+n]=t.item.outerHeight()+a+o}this.colHeights[d]=l[d],d++}this.element.css("height",Math.max.apply(Math,l))},onResize:function(){this.refresh()}},{width:200,gutter:20,rtl:!1,defer:!0}),r.create("matrix",function(t){return new r.Matrix(this,t)}),r.Modal=r.Component.extend({name:"Modal",version:"2.0.0",blackout:null,constructor:function(e,i){this.options=i=this.setOptions(i),this.element=this.createElement().attr("role","dialog").aria("labelledby",this.id("title")).aria("describedby",this.id("content")),i.fullScreen&&this.element.addClass("is-fullscreen"),this.nodes=t(e),i.blackout&&(this.blackout=r.Blackout.instance(),i.stopScroll&&this.blackout.addHook("hidden",function(e){e&&t("body").removeClass("no-scroll")})),this.addEvents([["keydown","window","onKeydown"],["click","document","onShow","{selector}"],["click","element","hide",this.ns("close")],["click","element","onSubmit",this.ns("submit")]]),i.clickout&&this.addEvent("click","element","onHide"),this.initialize()},hide:function(){this.fireEvent("hiding"),this.element.conceal(),this.blackout&&this.blackout.hide(),this.fireEvent("hidden")},position:function(i){if(i!==!0){this.blackout&&this.blackout.hideLoader(),this.fireEvent("showing");var s=this.element.find(this.ns("content"));s.html(i),this.fireEvent("load",[i]),this.element.reveal(),this.options.fullScreen&&s.css("min-height",t(e).height()),this.fireEvent("shown")}},show:function(e,i){e&&(this.node=e=t(e),i||(i=this.readValue(e,this.readOption(e,"getContent"))||e.attr("href"))),this.blackout&&!this.element.is(":shown")&&this.blackout.show(),this.options.stopScroll&&t("body").addClass("no-scroll"),this.loadContent(i)},submit:function(){var t=this.element.find("form:first");if(t){this.fireEvent("submit",[t]);var i={url:t.attr("action"),type:(t.attr("method")||"post").toUpperCase()};e.FormData?(i.processData=!1,i.contentType=!1,i.data=new FormData(t[0])):i.data=t.serialize(),this.requestData(i)}},onHide:function(e){var i=this.element;("click"!==e.type||t(e.target).is(i))&&(e.preventDefault(),i.is(":shown")&&!i.hasClass("is-loading")&&this.hide())},onKeydown:function(t){27===t.keyCode&&this.element.is(":shown")&&this.hide()},onSubmit:function(t){t.preventDefault(),this.submit()}},{animation:"fade",blackout:!0,fullScreen:!1,stopScroll:!0,clickout:!0,getContent:"data-modal",template:'<div class="'+d+'modal"><div class="'+d+'modal-outer"><div class="'+d+'modal-inner" data-modal-content></div><button class="'+d+'modal-close" data-modal-close><span class="x"></span></button></div></div>'}),r.create("modal",function(t){return new r.Modal(this,t)},!0),r.OffCanvas=r.Component.extend({name:"OffCanvas",version:"2.0.0",container:null,primary:null,secondary:null,side:"left",opposite:"right",_loaded:!1,constructor:function(t,e){this.element=t=this.setElement(t).attr("role","complementary").conceal(),this.options=e=this.setOptions(e,t);var i=e.animation;r.isTouch&&"squish"===i&&(e.animation=i="push"),"on-top"!==i&&"squish"!==i&&(e.hideOthers=!0),this.container=t.parent().addClass(i),this.primary=t.siblings("[data-offcanvas-content]").attr("role","main"),this.secondary=t.siblings("[data-offcanvas-sidebar]"),this.side=t.data("offcanvas-sidebar")||"left",this.opposite="left"===this.side?"right":"left",this.addEvents([["ready","document","onReady"],["resize","window","onResize"]]),e.swipe&&this.addEvents("left"===this.side?[["swipeleft","element","hide"],["swiperight","container","onSwipe"]]:[["swipeleft","container","onSwipe"],["swiperight","element","hide"]]),e.selector&&this.addEvent("click","document","toggle",e.selector),this.initialize()},destructor:function(){this.hide()},hide:function(){this.fireEvent("hiding"),this.container.removeClass("move-"+this.opposite),this.element.conceal().removeClass("is-expanded").aria("expanded",!1),this.options.stopScroll&&t("body").removeClass("no-scroll"),this.fireEvent("hidden")},show:function(){var e=this.options;e.hideOthers&&this.secondary.each(function(){var e=t(this);e.hasClass("is-expanded")&&e.toolkit("offCanvas","hide")}),this.fireEvent("showing"),this.container.addClass("move-"+this.opposite),this.element.reveal().addClass("is-expanded").aria("expanded",!0),e.stopScroll&&t("body").addClass("no-scroll"),this.fireEvent("shown")},toggle:function(){this.element.hasClass("is-expanded")?this.hide():this.show()},onReady:function(){if(this.options.openOnLoad&&!this._loaded){var t=this.element,e=this.primary,i="no-transition";t.addClass(i),e.addClass(i),this.show(),setTimeout(function(){t.removeClass(i),e.removeClass(i)},15),this._loaded=!0}},onResize:function(){this.fireEvent("resize")},onSwipe:function(e){e.preventDefault();var i=t(e.target),s="[data-offcanvas-sidebar]";i.is(s)||i.parents(s).length||this.show()}},{selector:"",animation:"push",openOnLoad:!1,hideOthers:!0,stopScroll:!0,swipe:r.isTouch}),r.create("offCanvas",function(t){return new r.OffCanvas(this,t)}),r.Pin=r.Component.extend({name:"Pin",version:"2.0.0",active:!0,elementHeight:null,elementTop:0,parentHeight:null,parentTop:null,viewport:{},constructor:function(e,i){this.element=e=this.setElement(e),this.options=i=this.setOptions(i,e),e.attr("role","complementary").addClass(i.animation),this.elementTop=parseInt(e.css("top"),10);var s=i.throttle;this.addEvents([["scroll","window",t.throttle(this.onScroll.bind(this),s)],["resize","window",t.throttle(this.onResize.bind(this),s)],["ready","document","onResize"]]),this.initialize()},destructor:function(){this.active=!1,setTimeout(function(){this.element.removeAttr("style").removeClass("is-pinned")}.bind(this),15)},calculate:function(){var i=t(e),s=this.options,n=s.context?this.element.parents(s.context):this.element.parent();this.viewport={width:i.width(),height:i.height()},this.elementHeight=this.element.outerHeight(!0),this.parentHeight=n.height(),this.parentTop=n.offset().top,this.active=s.lock&&this.elementHeight>=this.viewport.height?!1:this.element.is(":visible")&&this.parentHeight>this.elementHeight},pin:function(){var i=this.options;if(i.calculate&&this.calculate(),this.active){var s=this.elementHeight,n=this.elementTop,o=this.parentHeight,a=this.parentTop,h=t(e).scrollTop(),r={},l=i.xOffset,d=0;if(a>h)return void this.element.removeAttr("style").removeClass("is-pinned");var c=h+s,u=o+a;i.fixed?c>=u?(d="auto",r.position="absolute",r.bottom=0):(d=i.yOffset,r.position="fixed",r.bottom="auto"):(r.position="absolute",d+=c>=u?o-s:h-a+i.yOffset,n&&n>d&&(d=n)),r[i.location]=l,r.top=d,this.element.css(r).addClass("is-pinned")}},onResize:function(){this.calculate(),this.pin(),this.fireEvent("resize")},onScroll:function(){this.pin(),this.fireEvent("scroll")}},{location:"right",xOffset:0,yOffset:0,throttle:50,fixed:!1,calculate:!1,lock:!0}),r.create("pin",function(t){return new r.Pin(this,t)}),t.fn.positionTo=function(i,s,n,o){if(!i)return this;var a,h=n||{left:0,top:0},r=0,l=0,d=this.outerHeight(!0),c=this.outerWidth(!0),u=t(e),p=u.width(),m=u.height(),f=u.scrollTop();s.preventDefault?a={left:s.pageX,top:s.pageY}:(a=s.offset(),r=s.outerHeight(),l=s.outerWidth()),h.left+=a.left,h.top+=a.top;var v=h.top,g=h.left,w=i.split("-"),b={y:w[0],x:w[1]};return"top"===b.y?v-=d:"bottom"===b.y?v+=r:"center"===b.y&&(v-=Math.round(d/2-r/2)),"left"===b.x?g-=c:"right"===b.x?g+=l:"center"===b.x&&(g-=Math.round(c/2-l/2)),0>g?g=0:g+c>p&&(g=p-c),0>v?v=0:v+d>m+f&&(v=a.top-d),o&&("center"===b.y&&("left"===b.x?g-=15:"right"===b.x&&(g+=15)),"center"===b.x&&("top"===b.y?v-=10:"bottom"===b.y&&(v+=10))),this.css({left:g,top:v})},r.Tooltip=r.Component.extend({name:"Tooltip",version:"2.0.0",elementHead:null,elementBody:null,constructor:function(e,i){var s;this.options=i=this.setOptions(i),this.element=s=this.createElement().attr("role","tooltip").removeClass(i.className).css("display",""),"title"===i.getTitle&&(i.getTitle="data-"+this.keyName+"-title"),this.elementHead=s.find(this.ns("header")),this.elementBody=s.find(this.ns("content")),this.nodes=t(e).each(function(e,s){t(s).attr(i.getTitle,t(s).attr("title")).removeAttr("title")}),this.addEvent("{mode}","document","onShowToggle","{selector}"),"click"===i.mode?this.addEvents([["clickout","element","hide"],["clickout","document","hide","{selector}"]]):this.addEvent("mouseleave","document","hide","{selector}"),this.initialize()},hide:function(){this.fireEvent("hiding"),this.reset(),this.element.conceal(!0),this.node&&this.node.removeAttr("aria-describedby"),this.fireEvent("hidden")},position:function(e,i){var s=t.isEmptyObject(this.runtime)?this.options:this.runtime;if(e!==!0)if(this.fireEvent("showing"),this.element.addClass(s.position).addClass(s.className),this.node.aria("describedby",this.id()),i=i||this.readValue(this.node,s.getTitle),i&&s.showTitle?this.elementHead.html(i).show():this.elementHead.hide(),e?this.elementBody.html(e).show():this.elementBody.hide(),this.fireEvent("load",[e]),s.follow){var n=this.onFollow.bind(this);this.node.off("mousemove",n).on("mousemove",n),this.fireEvent("shown")}else this.element.reveal(!0).positionTo(s.position,this.node,{left:s.xOffset,top:s.yOffset}),this.fireEvent("shown")},reset:function(){var t=this.options,e=this.element,i=this.runtime.position||t.position,s=this.runtime.className||t.className;this.runtime={},e.removeClass(i).removeClass(s)},show:function(e,i){this.reset(),this.node=e=t(e),this.runtime=this.inheritOptions(this.options,e),this.loadContent(i||this.readValue(e,this.runtime.getContent))},onFollow:function(t){t.preventDefault();var e=this.runtime;this.element.reveal(!0).positionTo(e.position,t,{left:e.xOffset,top:e.yOffset},!0)},onRequestBefore:function(t){r.Component.prototype.onRequestBefore.call(this,t),this.options.showLoading&&this.position(r.messages.loading)}},{mode:"hover",animation:"fade",follow:!1,position:"top-center",showLoading:!0,showTitle:!0,getTitle:"title",getContent:"data-tooltip",mouseThrottle:50,xOffset:0,yOffset:0,template:'<div class="'+d+'tooltip"><div class="'+d+'tooltip-inner"><div class="'+d+'tooltip-head" data-tooltip-header></div><div class="'+d+'tooltip-body" data-tooltip-content></div></div><div class="'+d+'tooltip-arrow"></div></div>'}),r.create("tooltip",function(t){return new r.Tooltip(this,t)},!0);var u=r.Tooltip.prototype;r.Popover=r.Tooltip.extend({name:"Popover",version:"2.0.0",constructor:function(t,e){e=e||{},e.mode="click",e.follow=!1,u.constructor.call(this,t,e)},reset:function(){u.reset.call(this),this.node&&this.node.removeClass("is-active")},show:function(){u.show.apply(this,arguments),this.node&&this.node.addClass("is-active")}},{getContent:"data-popover",template:'<div class="'+d+'popover"><div class="'+d+'popover-inner"><div class="'+d+'popover-head" data-popover-header></div><div class="'+d+'popover-body" data-popover-content></div></div><div class="'+d+'popover-arrow"></div></div>'}),r.create("popover",function(t){return new r.Popover(this,t)},!0),r.Showcase=r.Component.extend({name:"Showcase",version:"2.0.0",animating:!1,blackout:null,caption:null,data:[],index:-1,items:[],tabs:[],constructor:function(e,i){var s;this.options=i=this.setOptions(i),this.element=s=this.createElement(),this.nodes=t(e),this.items=s.find(this.ns("items")),this.tabs=s.find(this.ns("tabs")),this.caption=s.find(this.ns("caption")),i.blackout&&(this.blackout=r.Blackout.instance()),this.addEvents([["keydown","window","onKeydown"],["click","document","onShow","{selector}"],["click","element","hide",this.ns("close")],["click","element","next",this.ns("next")],["click","element","prev",this.ns("prev")],["click","element","onJump",this.ns("tabs")+" a"]]),i.clickout&&this.addEvents([["clickout","document","onHide","{selector}"],["clickout","element","onHide"]]),i.swipe&&this.addEvents([["swipeleft","element","next"],["swiperight","element","prev"]]),this.addEvent(r.transitionEnd,"element",function(t){t.stopPropagation()},this.ns("items")),this.initialize()},hide:function(){this.fireEvent("hiding"),this.blackout&&this.blackout.hide(),this.options.stopScroll&&t("body").removeClass("no-scroll"),this.element.conceal().removeClass("is-single"),this.items.removeAttr("style").children("li").conceal(!0),this.fireEvent("hidden")},jump:function(e){if(!this.animating&&(e=t.bound(e,this.data.length),e!==this.index)){var i=this,s=this.element,n=this.caption,o=this.items,a=o.children("li"),h=a.eq(e),l=this.data,d=l[e],c=t.Deferred();if(this.fireEvent("jumping",[this.index]),this.tabs.find("a").removeClass("is-active").eq(e).addClass("is-active"),a.conceal(!0),n.conceal(),s.addClass("is-loading").aria("busy",!0),this.animating=!0,c.always(function(t,e){o.transitionend(function(){n.html(d.title).reveal(),h.reveal(!0),i.position(),i.animating=!1}),i._resize(t,e),s.removeClass("is-loading").aria("busy",!1),h.data("width",t).data("height",e)}),c.fail(function(){s.addClass("has-failed"),h.html(r.messages.error)}),h.data("width"))c.resolve(h.data("width"),h.data("height"));else{var u=new Image;u.src=d.image,u.onerror=function(){c.reject(150,150)},u.onload=function(){c.resolve(this.width,this.height),h.append(u)}}this.index=e,this.fireEvent("jumped",[e])}},next:function(){this.jump(this.index+1)},position:function(){this.fireEvent("showing"),this.blackout&&this.blackout.hideLoader(),this.element.reveal(),this.fireEvent("shown")},prev:function(){this.jump(this.index-1)},show:function(e){this.node=e=t(e),this.index=-1,this.element.reveal();var i=this.inheritOptions(this.options,e),s=this.readValue,n=s(e,i.getCategory),o=[],a=0;if(n)for(var h,r=0,l=0;h=this.nodes[r];r++)s(h,i.getCategory)===n&&(e.is(h)&&(a=l),o.push({title:s(h,i.getTitle),category:n,image:s(h,i.getImage)}),l++);else o.push({title:s(e,i.getTitle),category:n,image:s(e,i.getImage)});this.blackout&&this.blackout.show(),i.stopScroll&&t("body").addClass("no-scroll"),this._buildItems(o),this.jump(a)},_buildItems:function(e){this.data=e,this.items.empty(),this.tabs.empty();for(var i,s,n,o=0;n=e[o];o++)i=t("<li/>"),i.appendTo(this.items),s=t("<a/>").attr("href","javascript:;").data("showcase-index",o),i=t("<li/>"),i.appendTo(this.tabs).append(s);e.length<=1&&this.element.addClass("is-single"),this.fireEvent("load",[e])},_resize:function(i,s){var n,o,a=2*this.options.gutter,h=t(e).width()-a,r=t(e).height()-a;i>h&&(n=i/s,o=i-h,i=h,s-=Math.round(o/n)),s>r&&(n=s/i,o=s-r,i-=Math.round(o/n),s=r),this.items.css({width:i,height:s})},onHide:function(t){t.preventDefault();var e=this.element;e.is(":shown")&&!e.hasClass("is-loading")&&this.hide()},onJump:function(e){e.preventDefault(),this.jump(t(e.target).data("showcase-index")||0)},onKeydown:function(e){if(this.element.is(":shown"))switch(t.inArray(e.keyCode,[37,38,39,40])>=0&&e.preventDefault(),e.keyCode){case 27:this.hide();break;case 37:this.prev();break;case 38:this.jump(0);break;case 39:this.next();break;case 40:this.jump(-1)}}},{blackout:!0,stopScroll:!0,clickout:!0,swipe:r.isTouch,gutter:50,getCategory:"data-showcase",getImage:"href",getTitle:"title",template:'<div class="'+d+'showcase"><div class="'+d+'showcase-inner"><ul class="'+d+'showcase-items" data-showcase-items></ul><ol class="'+d+'showcase-tabs bullets" data-showcase-tabs></ol><button class="'+d+'showcase-prev" data-showcase-prev></button><button class="'+d+'showcase-next" data-showcase-next></button></div><button class="'+d+'showcase-close" data-showcase-close><span class="x"></span></button><div class="'+d+'showcase-caption" data-showcase-caption></div></div>'}),r.create("showcase",function(t){return new r.Showcase(this,t)},!0),r.Stalker=r.Component.extend({name:"Stalker",version:"2.0.0",container:t(e),targets:[],markers:[],offsets:[],constructor:function(e,i){if(this.element=e=this.setElement(e),this.options=i=this.setOptions(i),!i.target||!i.marker)throw new Error("A marker and target is required");"auto"===e.css("overflow")&&(this.container=e),this.addEvents([["scroll","container",t.throttle(this.onScroll.bind(this),i.throttle)],["ready","document","onScroll"]]),this.initialize(),this.refresh()},destructor:function(){this.targets.removeClass("is-active"),this.markers.removeClass("is-marked")},activate:function(t){this.stalk(t,"activate")},deactivate:function(t){this.stalk(t,"deactivate")},stalk:function(e,i){if(e=t(e),!("activate"===i&&e.hasClass("is-stalked")||"deactivate"===i&&!e.hasClass("is-stalked"))){var s,n,o,a=this.options,h=a.targetBy,r=a.markBy,l=this.targets.filter(function(){return t(this).attr(h).replace("#","")===e.attr(r)});"activate"===i?(s="activating",n="activated",o="addClass"):(s="deactivating",n="deactivated",o="removeClass"),this.fireEvent(s,[e,l]),e[o]("is-stalked"),l[o]("is-active"),this.fireEvent(n,[e,l])}},refresh:function(){var i,s=this.container.is(e),n=this.element.offset().top,o=[];"auto"!==this.element.css("overflow")||this.element.is("body")||(this.element[0].scrollTop=0),this.targets=t(this.options.target),this.markers=t(this.options.marker).each(function(e,a){i=t(a).offset(),s||(i.top-=n),o.push(i)}),this.offsets=o},onScroll:function(){var e=this.container.scrollTop(),i=this.offsets,s=this.options.onlyWithin,n=this.options.threshold;this.markers.each(function(o,a){a=t(a);var h=i[o],r=h.top-n,l=h.top+a.height()+n;s&&e>=r&&l>=e||!s&&e>=r?this.activate(a):this.deactivate(a)}.bind(this)),this.fireEvent("scroll")}},{target:"",targetBy:"href",marker:"",markBy:"id",threshold:50,throttle:50,onlyWithin:!0,applyToParent:!0}),r.create("stalker",function(t){return new r.Stalker(this,t)}),r.Tab=r.Component.extend({name:"Tab",version:"2.0.0",index:0,nav:null,sections:[],tabs:[],constructor:function(e,i){var s,n,o=this;this.element=e=this.setElement(e),this.options=i=this.setOptions(i,e),i.cookie||(i.cookie=e.attr("id")),this.sections=s=e.find(this.ns("section")).each(function(e,i){i=t(i),i.attr("role","tabpanel").attr("id",i.attr("id")||o.id("section",e)).aria("labelledby",o.id("tab",e)).conceal()}),this.nav=e.find(this.ns("nav")).attr("role","tablist"),this.tabs=n=this.nav.find("a").each(function(e){t(this).data("tab-index",e).attr({role:"tab",id:o.id("tab",e)}).aria({controls:s.eq(e).attr("id"),selected:!1,expanded:!1}).removeClass("is-active")}),this.addEvent("{mode}","element","onShow",this.ns("nav")+" a"),"click"!==i.mode&&i.preventDefault&&this.addEvent("click","element",function(t){t.preventDefault()},this.ns("nav")+" a"),this.initialize();var a=null;i.persistState&&(i.cookie&&t.cookie&&(a=t.cookie("toolkit.tab."+i.cookie)),null===a&&i.loadFragment&&location.hash&&(a=n.filter(function(){return t(this).attr("href")===location.hash}).eq(0).data("tab-index"))),n[a]||(a=i.defaultIndex),this.jump(a)},destructor:function(){this.jump(0)},hide:function(){this.fireEvent("hiding"),this.sections.conceal(),this.fireEvent("hidden")},jump:function(e){this.show(this.tabs[t.bound(e,this.tabs.length)])},show:function(e){e=t(e);var i=e.data("tab-index"),s=this.sections.eq(i),n=this.options,o=this.readValue(e,this.readOption(e,"getUrl"));this.fireEvent("showing",[this.index]),"javascript"!==o.substr(0,10)&&"#"!==o.substr(0,1)&&this.loadContent(o,{section:s}),this.tabs.aria("toggled",!1).removeClass("is-active"),i===this.index&&n.collapsible?s.is(":shown")?s.conceal():(e.aria("toggled",!0).addClass("is-active"),s.reveal()):(this.hide(),e.aria("toggled",!0).addClass("is-active"),s.reveal()),n.persistState&&t.cookie&&t.cookie("toolkit.tab."+n.cookie,i,{expires:n.cookieDuration}),this.index=i,this.node=e,this.fireEvent("shown",[i])},onRequestBefore:function(t){t.params.section.html(r.messages.loading).addClass("is-loading").aria("busy",!0)},onRequestDone:function(t,e,i){i.cache&&(this.cache[i.url]=t),this.fireEvent("load",[t]),i.params.section.html(t).removeClass("is-loading").aria("busy",!1)},onRequestFail:function(t){t.params.section.html(r.messages.error).removeClass("is-loading").addClass("has-failed").aria("busy",!1)},onShow:function(t){(this.options.preventDefault||"#"!==t.currentTarget.getAttribute("href").substr(0,1))&&t.preventDefault(),this.show(t.currentTarget)}},{mode:"click",collapsible:!1,defaultIndex:0,persistState:!1,preventDefault:!0,loadFragment:!0,cookie:null,cookieDuration:30,getUrl:"href"}),r.create("tab",function(t){return new r.Tab(this,t)}),r.Toast=r.Component.extend({name:"Toast",version:"2.0.0",constructor:function(e,i){this.nodes=e=t(e),this.options=i=this.setOptions(i,e),this.element=this.createElement().addClass(i.position).removeClass(i.animation).attr("role","log").aria({relevant:"additions",hidden:"false"}).appendTo(e).reveal(),this.initialize()},create:function(e,i){i=t.extend({},this.options,i||{});var s=this,n=t(i.toastTemplate).addClass(i.animation).attr("role","note").html(e).conceal().prependTo(this.element);this.fireEvent("create",[n]),setTimeout(function(){s.show(n)},15),i.duration&&setTimeout(function(){s.hide(n)},i.duration+15)},hide:function(e){e=t(e),this.fireEvent("hiding",[e]),e.transitionend(function(){e.remove(),this.fireEvent("hidden")}.bind(this)).conceal()},show:function(e){e=t(e),this.fireEvent("showing",[e]),e.reveal(),this.fireEvent("shown",[e])}},{position:"bottom-left",animation:"slide-up",duration:5e3,template:'<aside class="'+d+'toasts"></aside>',toastTemplate:'<div class="'+d+'toast"></div>'}),r.create("toast",function(t){return new r.Toast(this,t)}),r.TypeAhead=r.Component.extend({name:"TypeAhead",version:"2.0.0",index:-1,input:null,items:[],shadow:null,term:"",timer:null,wrapper:null,constructor:function(e,i){if(e=t(e),"input"!==e.prop("tagName").toLowerCase())throw new Error("TypeAhead must be initialized on an input field");var s=this;if(this.options=i=this.setOptions(i,e),this.element=this.createElement().attr("role","listbox").aria("multiselectable",!1),this.input=e,t.each({sorter:"sort",matcher:"match",builder:"build"},function(e,n){if(i[e]!==!1){var o;o=null===i[e]||"function"!==t.type(i[e])?s[n]:i[e],i[e]=o.bind(s)}}),i.prefetch&&"string"===t.type(i.source)){var n=i.source;t.getJSON(n,i.query,function(t){s.cache[n]=t})}i.shadow&&(this.wrapper=t(this.options.shadowTemplate),this.shadow=this.input.clone().addClass("is-shadow").removeAttr("id").prop("readonly",!0).aria("readonly",!0),this.input.addClass("not-shadow").replaceWith(this.wrapper),this.wrapper.append(this.shadow).append(this.input)),e.attr({autocomplete:"off",autocapitalize:"off",autocorrect:"off",spellcheck:"false",role:"combobox"}).aria({autocomplete:"list",owns:this.element.attr("id"),expanded:!1}),this.addEvents([["keyup","input","onLookup"],["keydown","input","onCycle"],["clickout","element","hide"]]),this.initialize()},destructor:function(){this.shadow&&(this.shadow.parent().replaceWith(this.input),this.input.removeClass("not-shadow"))},build:function(e){var i=t("<a/>",{href:"javascript:;",role:"option","aria-selected":"false"});return i.append(t(this.options.titleTemplate).html(this.highlight(e.title))),e.description&&i.append(t(this.options.descTemplate).html(e.description)),i},hide:function(){this.fireEvent("hiding"),this.shadow&&this.shadow.val(""),this.input.aria("expanded",!1),this.element.conceal(),this.fireEvent("hidden")},highlight:function(e){for(var i,s=this.term.replace(/[\-\[\]\{\}()*+?.,\\^$|#]/g,"\\$&").split(" "),n=this.options,o=function(e){return t(n.highlightTemplate).html(e).toString()},a=0;i=s[a];a++)e=e.replace(new RegExp(i,"ig"),o);return e},lookup:function(t){this.term=t,this.timer=setTimeout(this.onFind.bind(this),this.options.throttle)},match:function(t,e){return t.title.toLowerCase().indexOf(e.toLowerCase())>=0},position:function(){if(!this.items.length)return void this.hide();this.fireEvent("showing");var t=this.input.offset();this.element.css({left:t.left,top:t.top+this.input.outerHeight()}).reveal(),this.input.aria("expanded",!0),this.fireEvent("shown")},rewind:function(){this.index=-1,this.element.find("li").removeClass("is-active")},select:function(t,e){this.index=t;var i=this.element.find("li");if(i.removeClass("is-active").find("a").aria("selected",!1),t>=0){if(this.items[t]){var s=this.items[t];i.eq(t).addClass("is-active").find("a").aria("selected",!0),this.input.val(s.title),this.fireEvent(e||"select",[s,t])}}else this.input.val(this.term),this.fireEvent("reset")},sort:function(t){return t.sort(function(t,e){return t.title.localeCompare(e.title)})},source:function(e){if(!this.term.length||!e.length)return void this.hide();var i,s=this.options,n=this.term,o={_empty_:[]},a=t("<ul/>");this.items=[],this.index=-1,"function"===t.type(s.sorter)&&(e=s.sorter(e)),"function"===t.type(s.matcher)&&(e=e.filter(function(t){return s.matcher(t,n)}));for(var h=0;i=e[h];h++)i.category?(o[i.category]||(o[i.category]=[]),o[i.category].push(i)):o._empty_.push(i);var r=[],l=0;t.each(o,function(e,n){var o=[];"_empty_"!==e&&(r.push(null),o.push(t(s.headingTemplate).append(t("<span/>",{text:e}))));for(var h,d=0;(i=n[d])&&!(l>=s.itemLimit);d++)h=s.builder(i),h.on({mouseover:this.rewind.bind(this),click:t.proxy(this.onSelect,this,r.length)}),o.push(t("<li/>").append(h)),r.push(i),l++;a.append(o)}.bind(this)),this.element.empty().append(a),this.items=r,this.cache[n.toLowerCase()]=r.filter(function(t){return null!==t}),this.fireEvent("load"),this._shadow(),this.position()},_shadow:function(){if(this.shadow){var t=this.input.val(),e=t.toLowerCase(),i="";if(this.cache[e]&&this.cache[e][0]){var s=this.cache[e][0].title;0===s.toLowerCase().indexOf(e)&&(i=t+s.substr(t.length,s.length-t.length))}this.shadow.val(i)}},onCycle:function(t){var e=this.items,i=Math.min(this.options.itemLimit,Math.max(0,e.length)),s="cycle";if(i&&this.element.is(":shown")){switch(t.keyCode){case 38:this.index-=e[this.index-1]?1:2,this.index<0&&(this.index=i);break;case 40:this.index+=e[this.index+1]?1:2,this.index>=i&&(this.index=-1);break;case 9:t.preventDefault();for(var n=0;!this.items[n];)n++;s="select",this.index=n,this.hide();break;case 13:t.preventDefault(),s="select",this.hide();break;case 27:this.index=-1,this.hide();break;default:return}this.shadow&&this.shadow.val(""),this.select(this.index,s)}},onFind:function(){var e=this.term,i=this.options,s=t.type(i.source);if(this.cache[e.toLowerCase()])this.source(this.cache[e.toLowerCase()]);else if("string"===s){var n=i.source,o=this.cache[n];if(o)this.source(o);else{var a=i.query;a.term=e,t.getJSON(n,a,this.source.bind(this))}}else if("array"===s)this.source(i.source);else{if("function"!==s)throw new Error("Invalid TypeAhead source type");var h=i.source.call(this);h&&this.source(h)}},onLookup:function(e){if(!(t.inArray(e.keyCode,[38,40,27,9,13])>=0)){clearTimeout(this.timer);var i=this.input.val().trim();i.length<this.options.minLength?(this.fireEvent("reset"),this.hide()):(this._shadow(),this.lookup(i))}},onSelect:function(t){this.select(t),this.hide()}},{source:[],minLength:1,itemLimit:15,throttle:250,prefetch:!1,shadow:!1,query:{},template:'<div class="'+d+'type-ahead"></div>',shadowTemplate:'<div class="'+d+'type-ahead-shadow"></div>',titleTemplate:'<span class="'+d+'type-ahead-title"></span>',descTemplate:'<span class="'+d+'type-ahead-desc"></span>',highlightTemplate:'<mark class="'+d+'type-ahead-highlight"></mark>',headingTemplate:'<li class="'+d+'type-ahead-heading"></li>',sorter:null,matcher:null,builder:null}),r.create("typeAhead",function(t){return new r.TypeAhead(this,t)}),t.event.special.verticalresize=function(){function i(e){var i=s.height();i!==n&&(n=i,t(e.target).trigger("verticalresize"))}var s=t(e),n=s.height();return{setup:function(){s.on("resize",i)},teardown:function(){s.off("resize",i)}}}()}(jQuery,window,document);